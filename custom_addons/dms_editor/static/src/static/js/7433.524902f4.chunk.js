"use strict";(self.webpackChunkfilesdna=self.webpackChunkfilesdna||[]).push([[7433],{47433:(a,e,l)=>{l.r(e),l.d(e,{default:()=>T});var n=l(75989),s=l(79843),i=l(2260),r=l(41893),t=l(19392),o=l(37734);const u=JSON.parse('[{"label":"Afrikaans","value":"af"},{"label":"Albanian","value":"sq"},{"label":"Amharic","value":"am"},{"label":"Arabic","value":"ar"},{"label":"Armenian","value":"hy"},{"label":"Azerbaijani","value":"az"},{"label":"Basque","value":"eu"},{"label":"Belarusian","value":"be"},{"label":"Bengali","value":"bn"},{"label":"Bosnian","value":"bs"},{"label":"Bulgarian","value":"bg"},{"label":"Catalan","value":"ca"},{"label":"Cebuano","value":"ceb (ISO-639-2)"},{"label":"Chinese (Simplified)","value":"zh-CN"},{"label":"Chinese (Traditional)","value":"zh-TW"},{"label":"Corsican","value":"co"},{"label":"Croatian","value":"hr"},{"label":"Czech","value":"cs"},{"label":"Danish","value":"da"},{"label":"Dutch","value":"nl"},{"label":"English","value":"en"},{"label":"Esperanto","value":"eo"},{"label":"Estonian","value":"et"},{"label":"Finnish","value":"fi"},{"label":"French","value":"fr"},{"label":"Frisian","value":"fy"},{"label":"Galician","value":"gl"},{"label":"Georgian","value":"ka"},{"label":"German","value":"de"},{"label":"Greek","value":"el"},{"label":"Gujarati","value":"gu"},{"label":"Haitian Creole","value":"ht"},{"label":"Hausa","value":"ha"},{"label":"Hawaiian","value":"haw"},{"label":"Hebrew","value":"he or iw"},{"label":"Hindi","value":"hi"},{"label":"Hmong","value":"hmn"},{"label":"Hungarian","value":"hu"},{"label":"Icelandic","value":"is"},{"label":"Igbo","value":"ig"},{"label":"Indonesian","value":"id"},{"label":"Irish","value":"ga"},{"label":"Italian","value":"it"},{"label":"Japanese","value":"ja"},{"label":"Javanese","value":"jv"},{"label":"Kannada","value":"kn"},{"label":"Kazakh","value":"kk"},{"label":"Khmer","value":"km"},{"label":"Kinyarwanda","value":"rw"},{"label":"Korean","value":"ko"},{"label":"Kurdish","value":"ku"},{"label":"Kyrgyz","value":"ky"},{"label":"Lao","value":"lo"},{"label":"Latin","value":"la"},{"label":"Latvian","value":"lv"},{"label":"Lithuanian","value":"lt"},{"label":"Luxembourgish","value":"lb"},{"label":"Macedonian","value":"mk"},{"label":"Malagasy","value":"mg"},{"label":"Malay","value":"ms"},{"label":"Malayalam","value":"ml"},{"label":"Maltese","value":"mt"},{"label":"Maori","value":"mi"},{"label":"Marathi","value":"mr"},{"label":"Mongolian","value":"mn"},{"label":"Myanmar (Burmese)","value":"my"},{"label":"Nepali","value":"ne"},{"label":"Norwegian","value":"no"},{"label":"Nyanja (Chichewa)","value":"ny"},{"label":"Odia (Oriya)","value":"or"},{"label":"Pashto","value":"ps"},{"label":"Persian","value":"fa"},{"label":"Polish","value":"pl"},{"label":"Portuguese (Portugal, Brazil)","value":"pt"},{"label":"Punjabi","value":"pa"},{"label":"Romanian","value":"ro"},{"label":"Russian","value":"ru"},{"label":"Samoan","value":"sm"},{"label":"Scots Gaelic","value":"gd"},{"label":"Serbian","value":"sr"},{"label":"Sesotho","value":"st"},{"label":"Shona","value":"sn"},{"label":"Sindhi","value":"sd"},{"label":"Sinhala (Sinhalese)","value":"si"},{"label":"Slovak","value":"sk"},{"label":"Slovenian","value":"sl"},{"label":"Somali","value":"so"},{"label":"Spanish","value":"es"},{"label":"Sundanese","value":"su"},{"label":"Swahili","value":"sw"},{"label":"Swedish","value":"sv"},{"label":"Tagalog (Filipino)","value":"tl"},{"label":"Tajik","value":"tg"},{"label":"Tamil","value":"ta"},{"label":"Tatar","value":"tt"},{"label":"Telugu","value":"te"},{"label":"Thai","value":"th"},{"label":"Turkish","value":"tr"},{"label":"Turkmen","value":"tk"},{"label":"Ukrainian","value":"uk"},{"label":"Urdu","value":"ur"},{"label":"Uyghur","value":"ug"},{"label":"Uzbek","value":"uz"},{"label":"Vietnamese","value":"vi"},{"label":"Welsh","value":"cy"},{"label":"Xhosa","value":"xh"},{"label":"Yiddish","value":"yi"},{"label":"Yoruba","value":"yo"},{"label":"Zulu","value":"zu"}]');var c,d=l(6819),v=l(35676),b=l(99386),g=l(68265),m=l(87094),h=l(41988),p=l(11569),A=l(72612),x=l(1203),j=l(53079),y=l(41135),f=l(41397),P=l(9950),w=l(57528),k=l(33753);const S=(0,l(73053).A)(k.Ay.div(c||(c=(0,w.A)(["\n  & .ocrPreviewMain {\n    & > .langOption {\n      margin-bottom: 15px;\n      width: 100%;\n    }\n\n    & .ocrPages {\n      & > div {\n        height: 400px;\n        padding: 10px;\n        border: 1px solid #ccc;\n        display: none;\n\n        &.active {\n          display: block;\n          overflow-y: auto;\n          white-space: pre-wrap;\n        }\n      }\n    }\n\n    & .ocrActions {\n      margin-top: 10px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n\n      & .pgNums {\n        flex: 1;\n      }\n\n      & .btns {\n        & button {\n          margin-right: 7px;\n\n          &:last-child {\n            margin-right: 0px;\n          }\n        }\n      }\n    }\n  }\n"]))));var C=l(44414);const{Option:O}=b.A;const T=function(a){const{visible:e=!1,onClose:l=(()=>{}),rowData:c={}}=a,[w]=g.A.useForm(),[k,T]=(0,P.useState)({cLoading:!1,step:"ocr-scan",activeOcr:1,ocrData:[],ocrDataTrans:null,totalPages:0,scanning:!1,submitting:!1,translating:!1}),[D,_]=(0,P.useState)({});(0,v.A)({form:w,visible:e,initVal:{pages:"all"}});const{ocrData:N,ocrDataTrans:L,activeOcr:z,step:F,cLoading:M,totalPages:I,scanning:B,submitting:q,translating:H}=k,{ocrDataAry:K,totalOcrPgs:G}=(0,P.useMemo)((()=>{const a=(0,f.isArray)(N)?N:[],e=(0,f.isArray)(L)?L:a;return{ocrDataAry:e,totalOcrPgs:e.length}}),[N,L]);function E(a){const e="next"===a?z+1:z-1;e>=1&&e<=G&&T((a=>({...a,activeOcr:e})))}async function U(a){if(a)if(D[a])T((e=>({...e,ocrDataTrans:D[a]})));else{T((a=>({...a,translating:!0})));try{const e=await(0,d.Ay)("file/ocr-translate",{lang:a,ocrData:N},"POST");e.success&&(0,f.isArray)(e.data)?(T((a=>({...a,translating:!1,ocrDataTrans:e.data}))),_((l=>({...l,[a]:e.data})))):(0,r.A)("error",e.message)}catch(e){T((a=>({...a,translating:!1}))),(0,r.A)("error")}}else T((a=>({...a,ocrDataTrans:null})))}return(0,P.useEffect)((()=>{e&&(_({}),async function(){T((a=>({...a,cLoading:!0,step:"ocr-scan",ocrData:[],activeOcr:1})));try{const a=await(0,d.Ay)("file/get-page-count",{document_id:c.id},"post");a.success?T((e=>({...e,totalPages:a.count||0,cLoading:!1}))):T((a=>({...a,cLoading:!1})))}catch(a){T((a=>({...a,cLoading:!1})))}}())}),[e]),(0,C.jsx)(y.A,{title:(0,C.jsx)(o.A,{id:"documents.ocrDoc",values:{doc:(0,C.jsx)("b",{children:c.name})}}),open:e,okText:(0,C.jsx)(o.A,{id:"ocr-preview"===F?"document.saveasPDF":"workflow.proceed"}),onCancel:q||B||H?null:l,onOk:q||B||H?null:function(){I?"ocr-scan"===F?w.validateFields().then((a=>{const e={...a};"all"===e.pages&&(e.start_page=1,e.end_page=I),async function(a){T((a=>({...a,scanning:!0})));try{const e=await(0,d.Ay)("file/ocr-scan",a,"POST");e.success&&(0,f.isArray)(e.data)?T((a=>({...a,scanning:!1,ocrData:e.data,step:"ocr-preview"}))):(0,r.A)("error",e.message)}catch(e){T((a=>({...a,scanning:!1}))),(0,r.A)("error")}}({...e,document_id:c.id,folder_id:c.folder_id})})):"ocr-preview"===F&&async function(){T((a=>({...a,submitting:!0})));try{const a=await(0,d.Ay)("file/ocr-pdf",{document_id:c.id,folder_id:c.folder_id,document_name:c.name,ocrData:K},"POST");a.success?((0,r.A)("success",a.message,"",4.5),l()):(0,r.A)("error",a.message),T((a=>({...a,submitting:!1})))}catch(a){T((a=>({...a,submitting:!1}))),(0,r.A)("error")}}():(0,r.A)("error")},okButtonProps:{disabled:"ocr-preview"===F&&!G},confirmLoading:q||B,width:"auto",style:{maxWidth:600},destroyOnClose:!0,children:(0,C.jsx)(S,{children:(0,C.jsx)(A.A,{spinning:M,children:(0,C.jsx)(g.A,{form:w,layout:"vertical",children:"ocr-scan"===F?B?(0,C.jsx)(j.Ay,{icon:(0,C.jsx)(i.A,{}),title:(0,C.jsx)(o.A,{id:"document.scanning"}),subTitle:(0,C.jsx)(o.A,{id:"document.scanDesc"})}):(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("p",{children:(0,C.jsx)(o.A,{id:"document.totalPages",values:{pages:(0,C.jsx)("span",{style:{fontSize:16},className:"fw550",children:I})}})}),(0,C.jsxs)(m.A,{className:"mt15",gutter:[12],children:[(0,C.jsx)(h.A,{span:24,children:(0,C.jsx)(g.A.Item,{label:(0,C.jsx)(o.A,{id:"common.pages"}),name:"pages",rules:[{required:!0,message:(0,C.jsx)(o.A,{id:"req.pages"})}],children:(0,C.jsxs)(b.A,{children:[(0,C.jsx)(O,{value:"all",children:(0,C.jsx)(o.A,{id:"common.all"})}),(0,C.jsx)(O,{disabled:I<=1,value:"range",children:(0,C.jsx)(o.A,{id:"common.customised"})})]})})}),(0,C.jsx)(g.A.Item,{noStyle:!0,shouldUpdate:(a,e)=>a.pages!==e.pages||a.end_page!==e.end_page||a.start_page!==e.start_page,children:a=>{let{getFieldValue:e}=a;return"all"===e("pages")?null:(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(h.A,{span:12,children:(0,C.jsx)(g.A.Item,{label:(0,C.jsx)(o.A,{id:"common.sPage"}),name:"start_page",rules:[{required:!0,message:(0,C.jsx)(o.A,{id:"req.sPage"})},a=>{let{getFieldValue:e}=a;return{validator:(a,l)=>l?l>I?Promise.reject((0,C.jsx)(o.A,{id:"err.smallerThanPage",values:{page:(0,C.jsx)(o.A,{id:"common.sPage"})}})):l>e("end_page")?Promise.reject((0,C.jsx)(o.A,{id:"err.sPageSmallEnd"})):Promise.resolve():Promise.resolve()}}],children:(0,C.jsx)(p.A,{min:1,style:{minWidth:"100%"}})})}),(0,C.jsx)(h.A,{span:12,children:(0,C.jsx)(g.A.Item,{label:(0,C.jsx)(o.A,{id:"common.ePage"}),name:"end_page",rules:[{required:!0,message:(0,C.jsx)(o.A,{id:"req.ePage"})},a=>{let{getFieldValue:e}=a;return{validator:(a,l)=>l?l>I?Promise.reject((0,C.jsx)(o.A,{id:"err.smallerThanPage",values:{page:(0,C.jsx)(o.A,{id:"common.ePage"})}})):l<e("start_page")?Promise.reject((0,C.jsx)(o.A,{id:"err.ePageBigStart"})):Promise.resolve():Promise.resolve()}}],children:(0,C.jsx)(p.A,{min:1,style:{minWidth:"100%"}})})})]})}})]})]}):"ocr-preview"===F?function(){var a;return(0,C.jsxs)("div",{className:"ocrPreviewMain",children:[(0,C.jsx)(b.A,{className:"langOption",showSearch:!0,placeholder:(0,C.jsx)(o.A,{id:"common.lang"}),options:u,filterOption:(a,e)=>{const l=a?a.toLowerCase():"",n=e.value?e.value.toLowerCase():"",s=e.label?e.label.toLowerCase():"";return n.indexOf(l)>=0||s.indexOf(l)>=0},onChange:U,allowClear:!0}),(0,C.jsxs)(A.A,{spinning:H,children:[G>0?(0,C.jsx)("div",{className:"ocrPages",children:(0,C.jsx)("div",{className:"active",children:(null===(a=K[(z||1)-1])||void 0===a?void 0:a.output)||""})}):(0,C.jsx)(x.A,{}),G>0&&(0,C.jsxs)("div",{className:"ocrActions",children:[(0,C.jsx)("div",{className:"pgNums",children:(0,C.jsx)(o.A,{id:"editor.pageOf",values:{page:z,total:G}})}),(0,C.jsxs)("div",{className:"btns",children:[(0,C.jsx)(t.A,{disabled:z<=1,onClick:()=>E("back"),shape:"circle",icon:(0,C.jsx)(n.A,{})}),(0,C.jsx)(t.A,{disabled:z>=G,onClick:()=>E("next"),shape:"circle",icon:(0,C.jsx)(s.A,{})})]})]})]})]})}():null})})})})}}}]);