"use strict";(self.webpackChunkfilesdna=self.webpackChunkfilesdna||[]).push([[7353],{60278:(e,t,n)=>{n.d(t,{A:()=>p});var s=n(37734),a=n(13771),i=n(6819),o=n(8187),l=n(99386),r=n(41397),c=n(9950),d=n(44414);const{Option:m,OptGroup:u}=l.A;const p=function(e){const{visible:t,onChange:n=(()=>{}),value:p,vlKey:h="",sProps:x={},contacts:f,setContacts:v=(()=>{}),cLoading:g,placeholder:j=""}=e,A=(0,c.useRef)(null),[b,C]=(0,c.useState)({addContactVis:!1,contacts:[],cLoading:!1});return(0,c.useEffect)((()=>{f&&C((e=>({...e,contacts:f,cLoading:g})))}),[f,g]),(0,c.useEffect)((()=>{t&&async function(e){C((e=>({...e,cLoading:!e.contacts})));try{const t=await(0,i.Ay)("contact/get-contact",e);t.success?C((e=>({...e,contacts:t.data||[],cLoading:!1}))):C((e=>({...e,cLoading:!1})))}catch(t){C((e=>({...e,cLoading:!1})))}}()}),[t]),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(l.A,{showSearch:!0,style:{width:"100%"},ref:A,placeholder:(0,d.jsx)(s.A,{id:j||"common.searchNew"}),onSelect:(e,t)=>{e&&"new"===e.toString()?C((e=>({...e,addContactVis:!0}))):n(e,(null===t||void 0===t?void 0:t.obj)||{})},value:p,filterOption:function(e,t){const n=(null===t||void 0===t?void 0:t.obj)||{},s=(null===t||void 0===t?void 0:t.key)||"";if(!(0,r.isEmpty)(n)){const t=n.email?n.email.toLowerCase():"",s=n.name?n.name.toLowerCase():"",a=n.first_name?n.first_name.toLowerCase():"",i=n.last_name?n.last_name.toLowerCase():"";return t.indexOf(e.toLowerCase())>=0||s.indexOf(e.toLowerCase())>=0||a.indexOf(e.toLowerCase())>=0||i.indexOf(e.toLowerCase())>=0}return"new"===s},loading:b.cLoading,...x,children:[(0,d.jsx)("div",{children:(0,d.jsx)("button",{onClick:()=>C((e=>({...e,addContactVis:!0}))),style:{fontWeight:550,border:"none",cursor:"pointer"},type:"button",children:(0,d.jsx)(s.A,{id:"common.addNew"})})}),(0,d.jsx)(u,{label:"Users",children:b.contacts.map((function(e){const t=(0,o.dS)(e.first_name,e.last_name);return(0,d.jsxs)(m,{value:e[h||"email"],obj:e,label:(0,d.jsx)("p",{style:{fontWeight:550},children:e.name?e.name:t}),children:[(0,d.jsx)("p",{style:{fontWeight:550},children:e.name?e.name:t}),(0,d.jsx)("p",{children:(e.email,e.email)})]},e.id)}))})]}),(0,d.jsx)(a.A,{visible:b.addContactVis,onClose:()=>{C((e=>({...e,addContactVis:!1})))},handleSubmit:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;const s={...e,name:(0,o.dS)(e.first_name,e.last_name)},a=[...b.contacts];a.push(s),t&&n(s[h||"email"],s),f?(v(a),C((e=>({...e,addContactVis:!1})))):C((e=>({...e,contacts:a,addContactVis:!1})))},modalData:{title:"user.addUser",selText:"document.makeUser"}})]})}},17353:(e,t,n)=>{n.r(t),n.d(t,{default:()=>w});var s,a=n(99386),i=n(52160),o=n(23072),l=n(9950),r=n(94118),c=n(8187),d=n(41397),m=n(57528),u=n(68265),p=n(24893),h=n(41135),x=n(37734),f=n(35676),v=n(41893),g=n(60278),j=n(33753),A=n(44414);const b=function(e){const{visible:t,onClose:n,handleSubmit:s,modalData:a={},setSigner:i}=e,o=a||{},[r]=u.A.useForm(),[c,m]=(0,l.useState)(!1),[h,j]=(0,l.useState)("contact-list"),[b,y]=l.useState(null);return(0,f.A)({form:r,visible:t,initVal:{is_selected:!1}}),(0,A.jsxs)(C,{title:(0,A.jsx)(x.A,{id:o.title||"documents.addRecipient"}),open:t,okText:(0,A.jsx)(x.A,{id:"common.submit"}),onCancel:c?null:n,onOk:c?null:function(){let e="";m(!0),"contact"===h?r.validateFields().then((t=>{e=s(t,h),i(t),(0,v.A)(e.status,e.message),m(!1),n()})):(e=s(b,h),"success"===e.status&&(i(b),n()),(0,v.A)(e.status,e.message),m(!1))},okButtonProps:{id:"add-user",disabled:"contact-list"===h&&(0,d.isEmpty)(b)},confirmLoading:c,width:400,children:[(0,A.jsx)(p.Ay.Group,{options:[{label:"Select from contact list",value:"contact-list"}],value:h,onChange:e=>{let{target:{value:t}}=e;return j(t)}}),"contact-list"===h&&(0,A.jsx)(g.A,{placeholder:"common.searchUser",onChange:(e,t)=>{y(t)},visible:t,sProps:{optionLabelProp:"label",allowClear:!0,dropdownMatchSelectWidth:!1,style:{minWidth:350,marginTop:10},onClear:()=>y({})},usersOnly:!0})]})},C=(0,j.Ay)(h.A)(s||(s=(0,m.A)([""]))),{Option:y}=a.A;const w=function(e){const{contacts:t,signer:n,setContacts:s,changeSigner:m,appendData:u,setAppendData:p,viewDoc:h,setSigner:x,docData:f={}}=e,[v,g]=(0,l.useState)(!1),j="Original"!==h.name,C=j?(0,d.uniqBy)(u.filter((e=>"setting"!==e.type)).map((e=>e.signer)).filter((e=>null!==e)),"email"):t;return(0,A.jsxs)("div",{className:"add-signers",children:[(0,A.jsx)("style",{children:"\n          .ant-select-selection-item {\n            line-height: unset !important; \n          }\n        "}),(0,A.jsx)(b,{visible:v,onClose:()=>{g(!1)},handleSubmit:function(e,n){return t.filter((t=>t.email===e.email)).length>0?{status:"error",message:"There is a recipient with email ".concat(e.email)}:!["contact-list","contact"].includes(n)&&(null===t||void 0===t?void 0:t.filter((e=>-1!==e.email.toLowerCase().indexOf("[group"))).length)>0?{status:"error",message:"Can not add more than two groups for one document"}:(s([...t,{...e,type:n}]),m(e),{status:"success",message:"A recipient was added successfully to this document."})},setSigner:x,signer:n,docData:f}),(0,A.jsxs)("p",{className:"title",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:["Recipient"," ",!j&&(0,A.jsx)(i.Ay,{className:" btn btn-primary",type:"link",onClick:()=>g(!0),style:{color:"#0097A7"},children:"Add new"})]}),(0,A.jsxs)(a.A,{style:{width:"100%",height:"fit-content"},notFoundContent:null,onSelect:(e,t)=>{const n=t&&null!==t&&void 0!==t&&t.obj?null===t||void 0===t?void 0:t.obj:null;m(n),x(n)},filterOption:function(e,t){const n=e||"",s=t&&t.obj?t.obj:{};if(!(0,d.isEmpty)(s)){const e=s.email?s.email.toLowerCase():"",t=s.first_name?s.first_name.toLowerCase():"",a=s.last_name?s.last_name.toLowerCase():"";return e.indexOf(n.toLowerCase())>=0||t.indexOf(n.toLowerCase())>=0||a.indexOf(n.toLowerCase())>=0}return!1},value:n?n.email:null,placeholder:"Select Recipient",children:[!j&&(0,A.jsx)(y,{value:null,obj:null,children:"No Recipient"},null),(0,d.isArray)(C)&&C.map((e=>(0,A.jsxs)(y,{value:null===e||void 0===e?void 0:e.email,obj:e,children:[(0,A.jsx)("div",{style:{backgroundColor:(0,c.DI)(null===e||void 0===e?void 0:e.email,50,80)},className:"avatar-div"}),(0,A.jsxs)("p",{style:{fontWeight:550,width:"calc( 100% - 30px)",float:"right"},children:[(0,c.dS)(null===e||void 0===e?void 0:e.first_name,null===e||void 0===e?void 0:e.last_name),t.length>1&&(null===n||void 0===n?void 0:n.email)!==(null===e||void 0===e?void 0:e.email)&&!j&&(0,A.jsx)(r.A,{className:"delete-user",onClick:n=>((e,n)=>{e.stopPropagation();const a=t.filter((e=>e.email!==n));s(a);const i=u.map((e=>{var t;return(null===e||void 0===e||null===(t=e.signer)||void 0===t?void 0:t.email)===n?{...e,signer:a[0]}:e}));p(i)})(n,null===e||void 0===e?void 0:e.email)}),(0,A.jsx)("br",{}),-1===(null===e||void 0===e?void 0:e.email.toLowerCase().indexOf("group-"))?null===e||void 0===e?void 0:e.email:""]})]},null===e||void 0===e?void 0:e.email)))]}),(0,A.jsx)(o.A,{})]})}},13771:(e,t,n)=>{n.d(t,{A:()=>f});var s=n(41893),a=n(37734),i=n(6819),o=n(35676),l=n(68265),r=n(41135),c=n(87094),d=n(41988),m=n(55902),u=n(9950),p=n(94885),h=n(8187),x=n(44414);const f=function(e){const{visible:t,onClose:n,handleSubmit:f,modalData:v={}}=e,g=v||{},[j]=l.A.useForm(),[A,b]=(0,u.useState)(!1);(0,o.A)({form:j,visible:t,initVal:{is_selected:!1}});const C=(0,x.jsx)(l.A.Item,{name:"country",className:"countryFormItem",style:{marginBottom:0},children:(0,x.jsx)(p.A,{keyType:"code",valType:"dial_code",className:"countryPicker",filterOption:h.Tk,showSearch:!0,dropDownCustom:!1,allCountries:!0,userVerification:!0,optionFilterProp:!0})});return(0,x.jsx)(r.A,{title:(0,x.jsx)(a.A,{id:g.title||"documents.addRecipient"}),open:t,okText:(0,x.jsx)(a.A,{id:"common.submit"}),onCancel:A?null:n,onOk:A?null:function(){j.validateFields().then((e=>{!async function(e){b(!0);try{const t=new FormData;t.append("email",e.email),t.append("first_name",e.first_name),t.append("phone_number",e.phone_number);const n=await(0,i.Ay)("contact/create",t,"POST",void 0,!0);n.success?((0,s.A)("success",n.message),f(e)):(0,s.A)("error",n.message),b(!1)}catch(t){b(!1),(0,s.A)("error")}}(e)}))},okButtonProps:{id:"add-user"},confirmLoading:A,children:(0,x.jsx)(l.A,{form:j,layout:"vertical",children:(0,x.jsxs)(c.A,{gutter:6,children:[(0,x.jsx)(d.A,{span:24,children:(0,x.jsx)(l.A.Item,{label:(0,x.jsx)(a.A,{id:"common.fullName"}),name:"first_name",rules:[{required:!0,message:(0,x.jsx)(a.A,{id:"req.name"})},{max:50,message:(0,x.jsx)(a.A,{id:"err.max.50char"})},{whitespace:!0,message:(0,x.jsx)(a.A,{id:"err.blankSpace"})}],children:(0,x.jsx)(m.A,{})})}),(0,x.jsx)(d.A,{span:24,children:(0,x.jsx)(l.A.Item,{label:(0,x.jsx)(a.A,{id:"antTable.title.email"}),name:"email",rules:[{required:!0,message:(0,x.jsx)(a.A,{id:"req.email"})},{type:"email",message:(0,x.jsx)(a.A,{id:"err.email"})},{max:255,message:(0,x.jsx)(a.A,{id:"err.max.255char"})}],children:(0,x.jsx)(m.A,{})})}),(0,x.jsx)(d.A,{span:24,children:(0,x.jsx)(l.A.Item,{label:(0,x.jsx)(a.A,{id:"common.phoneNo"}),name:"phone_number",rules:[{max:15,message:(0,x.jsx)(a.A,{id:"err.max.15char"})},{whitespace:!0,message:(0,x.jsx)(a.A,{id:"err.blankSpace"})}],children:(0,x.jsx)(m.A,{type:"number",addonBefore:C})})})]})})})}}}]);