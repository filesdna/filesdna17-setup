"use strict";(self.webpackChunkfilesdna=self.webpackChunkfilesdna||[]).push([[9041],{60278:(e,n,t)=>{t.d(n,{A:()=>p});var s=t(37734),o=t(13771),i=t(6819),l=t(8187),r=t(99386),a=t(41397),c=t(9950),d=t(44414);const{Option:u,OptGroup:m}=r.A;const p=function(e){const{visible:n,onChange:t=(()=>{}),value:p,vlKey:h="",sProps:v={},contacts:f,setContacts:g=(()=>{}),cLoading:x,placeholder:y=""}=e,A=(0,c.useRef)(null),[j,b]=(0,c.useState)({addContactVis:!1,contacts:[],cLoading:!1});return(0,c.useEffect)((()=>{f&&b((e=>({...e,contacts:f,cLoading:x})))}),[f,x]),(0,c.useEffect)((()=>{n&&async function(e){b((e=>({...e,cLoading:!e.contacts})));try{const n=await(0,i.Ay)("contact/get-contact",e);n.success?b((e=>({...e,contacts:n.data||[],cLoading:!1}))):b((e=>({...e,cLoading:!1})))}catch(n){b((e=>({...e,cLoading:!1})))}}()}),[n]),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(r.A,{showSearch:!0,style:{width:"100%"},ref:A,placeholder:(0,d.jsx)(s.A,{id:y||"common.searchNew"}),onSelect:(e,n)=>{e&&"new"===e.toString()?b((e=>({...e,addContactVis:!0}))):t(e,(null===n||void 0===n?void 0:n.obj)||{})},value:p,filterOption:function(e,n){const t=(null===n||void 0===n?void 0:n.obj)||{},s=(null===n||void 0===n?void 0:n.key)||"";if(!(0,a.isEmpty)(t)){const n=t.email?t.email.toLowerCase():"",s=t.name?t.name.toLowerCase():"",o=t.first_name?t.first_name.toLowerCase():"",i=t.last_name?t.last_name.toLowerCase():"";return n.indexOf(e.toLowerCase())>=0||s.indexOf(e.toLowerCase())>=0||o.indexOf(e.toLowerCase())>=0||i.indexOf(e.toLowerCase())>=0}return"new"===s},loading:j.cLoading,...v,children:[(0,d.jsx)("div",{children:(0,d.jsx)("button",{onClick:()=>b((e=>({...e,addContactVis:!0}))),style:{fontWeight:550,border:"none",cursor:"pointer"},type:"button",children:(0,d.jsx)(s.A,{id:"common.addNew"})})}),(0,d.jsx)(m,{label:"Users",children:j.contacts.map((function(e){const n=(0,l.dS)(e.first_name,e.last_name);return(0,d.jsxs)(u,{value:e[h||"email"],obj:e,label:(0,d.jsx)("p",{style:{fontWeight:550},children:e.name?e.name:n}),children:[(0,d.jsx)("p",{style:{fontWeight:550},children:e.name?e.name:n}),(0,d.jsx)("p",{children:(e.email,e.email)})]},e.id)}))})]}),(0,d.jsx)(o.A,{visible:j.addContactVis,onClose:()=>{b((e=>({...e,addContactVis:!1})))},handleSubmit:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;const s={...e,name:(0,l.dS)(e.first_name,e.last_name)},o=[...j.contacts];o.push(s),n&&t(s[h||"email"],s),f?(g(o),b((e=>({...e,addContactVis:!1})))):b((e=>({...e,contacts:o,addContactVis:!1})))},modalData:{title:"user.addUser",selText:"document.makeUser"}})]})}},12197:(e,n,t)=>{t.d(n,{A:()=>A});var s,o=t(9950),i=t(90101),l=t(1203),r=t(18469),a=t(98341),c=t(21270),d=t(37734),u=t(41397),m=t(98581),p=t(57528),h=t(33753),v=t(73053),f=t(1868);const g=(0,v.A)(h.Ay.div(s||(s=(0,p.A)(["\n  & .moveHome {\n    padding: 6px;\n    margin-bottom: 8px;\n    cursor: pointer;\n    transition: all 0.3s;\n\n    &:hover {\n      background-color: #f5f5f5;\n    }\n\n    &.selected {\n      background: ",";\n      color: #fff;\n    }\n\n    & p {\n      font-size: 15px;\n      & .anticon {\n        margin: ",";\n        font-size: 16px;\n      }\n    }\n  }\n\n  & .ant-tree {\n    & .ant-tree-list {\n      & .ant-tree-list-holder-inner {\n        overflow-x: auto;\n\n        & .ant-tree-treenode {\n          & .ant-tree-indent {\n            white-space: initial;\n          }\n        }\n      }\n\n      & .ant-tree-switcher,\n      & .ant-tree-iconEle {\n        height: 34px;\n        line-height: 34px;\n\n        & .anticon {\n          font-size: 13px;\n        }\n      }\n      & .ant-tree-iconEle {\n        & .anticon {\n          font-size: 18px;\n        }\n      }\n      & .ant-tree-node-content-wrapper {\n        min-height: 34px;\n        line-height: 34px;\n\n        & .ant-tree-title {\n          font-size: 15px;\n          font-weight: 500;\n          margin-left: 5px;\n        }\n      }\n    }\n  }\n"])),(0,f.palette)("primary",0),(e=>"rtl"===e["data-rtl"]?"0 25px 0 10px":"0 10px 0 0")));var x=t(44414);const{DirectoryTree:y}=i.A,A=e=>{const{visible:n=!1,onSelect:t=(()=>{}),height:s,selected:i=[],hint:p="",multiple:h=!1}=e,[v,f]=(0,o.useState)({loading:!1,data:[]}),A=(0,a.useSelector)((e=>e.Auth.userData)),j="undefined"!==typeof window?window.innerHeight:800,b=async e=>{if(!Array.isArray(e))return[];const n=e.map((async e=>{const n=e.is_sub?await(async e=>{const n={params:{login:A.email}};return(await r.A.post("".concat(m.A.apiDomain,"/api/attachments/file-sub-directories/").concat(e),n,{headers:{Accept:"application/json","Content-Type":"application/json"}})).data.result.directories||[]})(e.directory_id):[],t=await b(n);return{title:e.directory_name,key:e.directory_id.toString(),children:t}}));return Promise.all(n)};(0,o.useEffect)((()=>{if(n){const e=async()=>{const e=await(async()=>{const e={params:{login:A.email}};return(await r.A.post("".concat(m.A.apiDomain,"/api/attachments/file-directories"),e,{headers:{Accept:"application/json","Content-Type":"application/json"}})).data.result.directories||[]})(),n=await b(e);f({loading:!1,data:n})};f({loading:!0,data:[]}),e()}else t([])}),[n]);return(0,x.jsxs)(g,{children:[p&&(0,x.jsx)("p",{className:"mb20",children:(0,x.jsx)(d.A,{id:p})}),v.loading||(0,u.isEmpty)(v.data)?(0,x.jsx)(l.A,{description:(0,x.jsx)(d.A,{id:"documents.noDir"})}):(0,x.jsx)(c.A,{style:{height:s||j-Math.round(j/1.5)},children:(0,x.jsx)(y,{height:s,treeData:v.data,onSelect:e=>{const n=(0,u.isEqual)(e,i)?[]:e;t(n)},selectedKeys:i,multiple:h})})]})}},91141:(e,n,t)=>{t.d(n,{A:()=>r});var s=t(9950),o=t(67414),i=t(17420),l=t(44414);const r=function(e){const{id:n,index:t,moveList:r,children:a,style:c={},draggingStyle:d={},onClick:u={}}=e,m=(0,s.useRef)(null),[{isOver:p,dropClassName:h},v]=(0,o.H)({accept:"card",hover(e,n){var s;if(!m.current)return;const o=e.index,i=t;if(o===i)return;const l=null===(s=m.current)||void 0===s?void 0:s.getBoundingClientRect(),a=(l.bottom-l.top)/2,c=n.getClientOffset().y-l.top;o<i&&c<a||o>i&&c>a||(r(o,i),e.index=i)},collect:e=>{const{index:n}=e.getItem()||{};return n===t?{}:{isOver:e.isOver(),dropClassName:n<t?" drop-over-downward":" drop-over-upward"}}}),[{isDragging:f},g]=(0,i.i)({item:{type:"card",id:n,index:t},collect:e=>({isDragging:e.isDragging()})}),x=f?0:1;return g(v(m)),(0,l.jsx)("div",{ref:m,className:"".concat(p?h:""),style:{opacity:x,cursor:"move",...c,...f&&{...d}},onClick:u,id:n,children:a})}},49041:(e,n,t)=>{t.r(n),t.d(n,{default:()=>z});var s=t(82278),o=t(2260),i=t(34555),l=t(60278),r=t(91141),a=t(41893),c=t(19392),d=t(78254),u=t(37734),m=t(35116),p=t(6819),h=t(99386),v=t(68265),f=t(22748),g=t(53079),x=t(72612),y=t(87094),A=t(41988),j=t(55902),b=t(23072),w=t(16895),_=t(35398),C=t(29796),S=t(24893),k=t(45259),L=t(10495),P=t(41135),O=t(12197),D=t(94885),N=t(98581),T=t(49998),E=t(8187),I=t(12547),F=t(41397),q=t(9950),V=t(98341),B=t(55271),W=t(34845),M=t(44414);const{Option:U}=h.A;const z=function(e){var n,t,z,K,R;const{file:Y={},visible:H=!1,tempName:G,onClose:X=(()=>{}),handleSubmit:$=(()=>{}),apiAry:J=[],userData:Q={},docId:Z,setIsErp:ee=(()=>{})}=e,ne=(null!==Q&&void 0!==Q&&null!==(n=Q.sms_pack)&&void 0!==n&&n.sms_balance,(null===Q||void 0===Q||null===(t=Q.pack)||void 0===t||null===(z=t.security_pack)||void 0===z?void 0:z.is_free)||(null===Q||void 0===Q||null===(K=Q.pack)||void 0===K||null===(R=K.user_verification_pack)||void 0===R?void 0:R.is_free)),te=(0,q.useRef)(null),se=(0,V.useSelector)((e=>e.Auth.access)),oe=null===se||void 0===se?void 0:se.is_free_plan,ie=se.document_limit||oe,[le]=v.A.useForm(),[re,ae]=(0,q.useState)({roles:[],showPresign:!0,createType:"sendBulkSign",enableOrder:!1}),[ce,de]=((0,T.A)(),(0,q.useState)(!0)),[ue,me]=(0,q.useState)(!1),[pe,he]=(0,q.useState)([]),{submitting:ve,loading:fe}=re,[,ge]=(0,q.useState)(!1),[xe,ye]=(0,q.useState)(),[Ae,je]=(0,q.useState)([]),[be,we]=(0,q.useState)([1]),[_e,Ce]=(0,q.useState)([]),[Se,ke]=(0,q.useState)([]),[Le,Pe]=(0,q.useState)("DD/MM/YYYY"),[Oe,De]=(0,q.useState)(!1),[Ne,Te]=(0,q.useState)(),[Ee,Ie]=(0,q.useState)(),[Fe,qe]=(0,q.useState)(""),{changeDocumentId:Ve}=I.A,Be=(0,V.useDispatch)();(0,q.useEffect)((()=>{window.navigator.geolocation.getCurrentPosition((e=>{Te(e.coords.latitude),Ie(e.coords.longitude)}))}),[]),(0,q.useEffect)((()=>((async()=>{if(Ne&&Ee){var e;const n="".concat("https://maps.googleapis.com/maps/api/geocode/json","?latlng=").concat(Ne,",").concat(Ee,"&key=").concat("AIzaSyA9BeSbLN1pNhdceVC7_OqJwmI8-KOFiBE"),t=await fetch(n),s=await t.json(),o=await s.results.find((e=>e.types.includes("locality")));qe(null!==(e=null===o||void 0===o?void 0:o.formatted_address)&&void 0!==e?e:"")}})(),()=>{})),[Ne,Ee]);const We=(0,q.useRef)(null),Me=e=>{We.current.click()},Ue=e=>{const n=e.target.files[0];ye(null===n||void 0===n?void 0:n.name);const t=new FileReader;t.onload=e=>{const n=new Uint8Array(e.target.result),t=(0,B.LF)(n,{type:"array"}),s=t.SheetNames[0],o=t.Sheets[s],i=B.Wp.sheet_to_json(o,{header:1}),l=i.shift();if(i.length>1){const e=i.map((e=>l.reduce(((n,t,s)=>{var o;return n[t.toLowerCase()]=null!==(o=e[s])&&void 0!==o?o:null,n}),{})));je(e),(0,a.A)("success","Excel upload successfully")}else(0,a.A)("error","Incorrect file or data")},t.readAsArrayBuffer(n)};function ze(){if(_e.length>0){_e.unshift("file_name");const e=["Please name your file below"];!function(e){Se.map((n=>{switch(n.type){case"textbox":e.push("Please add your text below");break;case"date":{let t=n.format;e.push("Please use this format ".concat(t));break}case"email":e.push("Please add your email (test@test.com)");break;default:e.push("Please add your value below")}}))}(e);const n=[];n.push(_e),n.push(e);const t=B.Wp.book_new(),s=B.Wp.aoa_to_sheet(n);B.Wp.book_append_sheet(t,s,"Sheet1"),(0,B._h)(t,"sample.xlsx")}}async function Ke(e){ae((e=>({...e,submitting:!0})));try{const n=await(0,p.Ay)("template/use",{params:e},"POST",{...p.$K,"Content-Type":"application/json"});if(n.result.is_myself||ae((e=>({...e,submitting:!1}))),n.result.success){if(n.result.is_myself){const{docData:e}=n.result;await async function(e){try{const n=await(0,p.Ay)("file/finish",{params:{document_id:e.hash_url,type:"export",timezone:N.A.timezone,json_data:e.json_data}},"post",{...p.$K,"Content-Type":"application/json"});if(ae((e=>({...e,submitting:!1}))),n.result.success)setTimeout((()=>{(0,a.A)("success",n.result.message)}),300);else{const e=n.result.is_limit_exceed?"document.signUpgradeLimit":n.result.message;(0,a.A)("error",e)}}catch(n){ae((e=>({...e,submitting:!1}))),(0,a.A)("error")}}(e)}$(n.result.data),(0,a.A)("success","document.tempProcessStarted","document.tempProcessDesc")}else(0,a.A)("error",n.result.message)}catch(n){ae((e=>({...e,submitting:!1}))),(0,a.A)("error")}}(0,q.useEffect)((()=>{var e,n,t,s,o,i;(H&&!ie&&(!async function(){ae((e=>({...e,loading:!0})));let e=!0,n=[],t=null;if((0,F.isEmpty)(J)){const e=await(0,p.Ay)("files/get-append-data/".concat(Z));if(!1!==e.success){t=e;const n=[],s=[];for(const t of e)Object.hasOwn(t,"column_name")&&(n.push(t.column_name),"date"!==t.type?s.push({type:t.type}):s.push({type:t.type,format:t.font.dateFormat}));Ce(n),ke(s)}else ae((e=>({...e,loading:!1})))}else t=J;he(t),(0,F.isEmpty)(t)?((0,a.A)("No Params..."),ae((e=>({...e,loading:!1})))):(t.filter((e=>!["icon","qr","barcode","textbox1","setting","highlight","date1","refnumber"].includes(e.type))).forEach((n=>{!He(n.role)||void 0!==n.is_completed&&!1!==n.is_completed||(e=!1)})),t.forEach((e=>{e.role&&n.push(e.role)})),n=n.filter(((e,n,t)=>n===t.findIndex((n=>n.id===e.id)))),n.length>0?await ae((e=>({...e,roles:n,loading:!1}))):ae((e=>({...e,loading:!1})))),await ae((e=>({...e,showPresign:t.filter((e=>!["icon","qr","barcode","textbox1","setting","highlight","date1","refnumber"].includes(e.type)&&He(e.role))).length>0}))),await de(e),(1===n.length&&n.find((e=>0===e.id||1===e.id))&&t.find((e=>"sign"===e.type))||t.find((e=>"sign"===e.type&&ce&&e.data)))&&me(!0)}(),async function(e){ae((e=>({...e,cLoading:!e.contacts})));try{const n=await(0,p.Ay)("contact/get-contact",e);n.success?ae((e=>({...e,contacts:n.data||[],cLoading:!1}))):ae((e=>({...e,cLoading:!1})))}catch(n){ae((e=>({...e,cLoading:!1})))}}({type:"sign",getGroup:!0}),setTimeout((()=>{null!==te&&void 0!==te&&te.current&&te.current.focus()}),100)),(0,F.isEmpty)(Q))||(28===(null===(e=Q.plan)||void 0===e||null===(n=e.currentPlan)||void 0===n?void 0:n.id)||null!==(t=Q.pack)&&void 0!==t&&null!==(s=t.security_pack)&&void 0!==s&&s.is_free||null!==(o=Q.pack)&&void 0!==o&&null!==(i=o.user_verification_pack)&&void 0!==i&&i.is_free?ge(!1):ge(!0))}),[H]);const Re=()=>{var e;const n=(0,M.jsx)(u.A,{id:"err.user.homeDirectory"});return(null!==(e=be.length<=0)&&void 0!==e?e:be.includes(0))?Promise.reject(n):Promise.resolve()};function Ye(){je([]),X()}function He(e){return null!==e&&void 0!==e&&e.name?"myself"===(null===e||void 0===e?void 0:e.name.toLowerCase())||"fromcsv"===(null===e||void 0===e?void 0:e.name.toLowerCase()):"myself"===(null===e||void 0===e?void 0:e.email.toLowerCase())||"fromcsv"===(null===e||void 0===e?void 0:e.email.toLowerCase())}function Ge(e){const n=[...re.roles].map(((n,t)=>{const s={...n};return s.order_by=e?t+1:0,s}));ae((t=>({...t,roles:n,enableOrder:e})))}const Xe=(0,q.useCallback)(((e,n)=>{const t=re.roles[e],s=(0,F.cloneDeep)(re.roles);s[e].order_by=n+1,s.splice(e,1),s.splice(n,0,t);const o=(0,F.map)(s,((e,n)=>{const t={...e};return t.order_by=n+1,t}));ae((e=>({...e,roles:o})))}),[re.roles]),$e=(0,M.jsx)(f.A,{title:(0,M.jsx)(u.A,{id:"common.upgradePlanForSecurity"}),placement:"bottom",children:(0,M.jsx)("span",{className:"iconSpan",children:(0,M.jsx)(s.A,{})})});return(0,q.useEffect)((()=>{re&&!1===(null===re||void 0===re?void 0:re.loading)&&0===re.roles.length&&((0,a.A)("error","Please add dynamic fields first"),Ye())}),[re,re.roles]),(0,M.jsx)(P.A,{title:(0,M.jsx)(u.A,{id:"document.createDoc"}),open:H,onCancel:ve?null:Ye,onOk:fe?null:async function(){var e;const n=re.roles.filter((e=>![0,1].includes(e.id)));!(n.length<1&&re.roles.filter((e=>[0,1].includes(e.id))).length)&&n.length<1?(0,a.A)("error","You need to add at least one role."):ce?(null===n||void 0===n?void 0:n.filter((e=>!(0,F.isObject)(null===e||void 0===e?void 0:e.user))).length)>0?(0,a.A)("error","Please assign an user/group for each role"):re.roles.filter((e=>1===e.id)).length>1&&0===Ae.length?(0,a.A)("error","Please upload csv file"):(null===(e=n.filter((e=>{var n;return Boolean(null===e||void 0===e||null===(n=e.user)||void 0===n?void 0:n.members)})))||void 0===e?void 0:e.length)>1?(0,a.A)("error","Can't use more than one group, One group is maximum that you can use as recipient"):le.validateFields().then((async e=>{const n={...e};n.template_id=Y.id;const t={};if((0,F.isEmpty)(re.roles))return void(0,a.A)("error","Please create role(s) first and assign them to your input fields");re.roles.forEach(((e,n)=>{null===e||void 0===e||!e.name||null!==e&&void 0!==e&&e.email||0;try{t[e.id]={...e.user,order_by:re.enableOrder?n+1:0}}catch(s){}})),n.assign_roles=t,n.type=re.createType?re.createType:void 0,n.apiAry=pe,n.is_last_completed=ue;const[s]=be;n.folder_id=s;const o=Ae.map((e=>{for(const n in e){var t;if(Object.hasOwn(e,n)&&null!==(t=e[n])&&void 0!==t&&t.toString().startsWith("Please "))return}const s=function(e,n){let t=[];for(const s of e)Object.hasOwn(n,s)&&t.push({[s]:n[s]});return t}(function(e,n){let t=[];for(const s of n)for(const n in s)e.includes(s[n])&&t.push(s[n]);return(0,F.uniqBy)(t)}(Object.keys(e),pe),e);return{...n,name:(null===e||void 0===e?void 0:e.file_name)||Date.now(),apiAry:pe.map((e=>{const n=s.find((n=>n[e.column_name]));return n?{...e,data:n[e.column_name]}:e}))}})).filter((e=>e)).slice(0,-1);Ae.length>0?async function(e){ae((e=>({...e,submitting:!0})));try{ae((e=>({...e,submitting:!1}))),(0,a.A)("success","document.tempProcessStarted","document.tempProcessDesc"),window.history.back();const n=await(0,p.Ay)("template/use-csv",{params:e},"POST");n.result.success&&($(),(0,a.A)("success",n.result.message))}catch(n){ae((e=>({...e,submitting:!1}))),(0,a.A)("error")}}({folder_id:s,location:Fe,csv:o}):await Ke(n)})).catch((e=>console.log("form errors ::",e))):(0,a.A)("error",'Please fill "Myself" filed first')},confirmLoading:ve,okText:(0,M.jsx)(u.A,{id:"common.submit"}),okButtonProps:{id:"create-new-doc"},footer:ie||ve?null:void 0,children:(0,M.jsx)(W.Ky,{children:function(){var e,n,t,s,p;return ie?(0,M.jsx)(d.default,{msg:oe?"upgrade.subTxt":"upgrade.reasonDoc"}):ve?(0,M.jsx)(g.Ay,{icon:(0,M.jsx)(o.A,{}),title:(0,M.jsx)(u.A,{id:"document.creatingDoc"}),subTitle:(0,M.jsx)(u.A,{id:"document.creatingDocMsg"})}):(0,M.jsx)(v.A,{form:le,layout:"vertical",children:(0,M.jsx)(x.A,{spinning:fe,children:(0,M.jsxs)(y.A,{children:[(null===re||void 0===re||null===(e=re.roles)||void 0===e?void 0:e.find((e=>{var n;return"fromcsv"!==(null===e||void 0===e||null===(n=e.email)||void 0===n?void 0:n.toLowerCase())})))&&(0,M.jsx)(A.A,{xs:24,children:(0,M.jsx)(v.A.Item,{name:"name",label:(0,M.jsx)(u.A,{id:"common.filename"}),rules:[{required:!0,message:(0,M.jsx)(u.A,{id:"req.name"})},{max:50,message:(0,M.jsx)(u.A,{id:"err.min.50char"})},{whitespace:!0,message:(0,M.jsx)(u.A,{id:"err.blankSpace"})}],children:(0,M.jsx)(j.A,{ref:te})})}),(0,F.isArray)(null===re||void 0===re?void 0:re.roles)&&!(0,F.isEmpty)(re.roles)&&(0,M.jsxs)(M.Fragment,{children:[(null===re||void 0===re?void 0:re.roles.find((e=>{var n;return"fromcsv"===(null===e||void 0===e||null===(n=e.email)||void 0===n?void 0:n.toLowerCase())})))&&(0,M.jsx)("span",{style:{color:"#ff4d4f"},children:"Note: Please follow the below steps"}),(0,M.jsx)(b.A,{}),!(1===(null===re||void 0===re?void 0:re.roles.length)&&null!==re&&void 0!==re&&re.roles.find((e=>0===e.id||1===e.id)))&&(0,M.jsxs)("h3",{className:"mb10",style:{width:"100%"},children:[(0,M.jsx)(u.A,{id:"role.assignPeople"}),(0,M.jsx)(w.A,{size:"small",style:{float:"right"},onChange:Ge,checked:re.enableOrder})]}),re.showPresign&&(0,M.jsxs)(A.A,{span:24,children:[(null===re||void 0===re||null===(n=re.roles)||void 0===n?void 0:n.find((e=>{var n;return"myself"===(null===e||void 0===e||null===(n=e.email)||void 0===n?void 0:n.toLowerCase())})))&&(0,M.jsxs)("div",{className:"asign-people",children:[(0,M.jsx)("p",{children:"Myself"}),ce?(0,M.jsxs)("span",{children:[(0,M.jsx)(i.A,{twoToneColor:"#52c41a"}),(0,M.jsx)("span",{style:{marginLeft:"4px",color:"#808080"},children:"Done"})]}):(0,M.jsx)(c.A,{onClick:()=>{ce||(Z?(document.getElementById("root").setAttribute("data-path","/document/".concat(Z,"/presign?").concat(le.getFieldValue("name"))),Be(Ve("/document/".concat(Z,"/presign?").concat(le.getFieldValue("name"))))):(0,a.A)("error"))},type:"primary",children:(0,M.jsx)("span",{children:"Start"})},"home")]}),(null===re||void 0===re||null===(t=re.roles)||void 0===t?void 0:t.find((e=>{var n;return"fromcsv"===(null===e||void 0===e||null===(n=e.email)||void 0===n?void 0:n.toLowerCase())})))&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)("div",{className:"asign-people",style:{width:"100%"},children:(0,M.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,M.jsx)("p",{children:"Step - 1"}),(0,M.jsxs)("div",{style:{marginLeft:"30px"},children:[(0,M.jsx)(c.A,{type:"primary",title:"Download",onClick:ze,children:"Download sample excel"}),(0,M.jsx)("br",{}),(0,M.jsx)("span",{style:{color:"#ff4d4f",fontSize:"12px"},children:"Note: Download sample csv file, fill it and save it"})]})]})}),(0,M.jsx)(b.A,{}),(0,M.jsx)("div",{className:"asign-people",style:{width:"100%"},children:(0,M.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,M.jsx)("p",{children:"Step - 2"}),(0,M.jsxs)("div",{style:{alignItems:"center",justifyContent:"space-between"},children:[(0,M.jsx)(c.A,{title:"Upload",type:"primary",onClick:Me,style:{marginLeft:"30px"},children:"Upload Excel"}),xe&&(0,M.jsxs)("span",{style:{marginLeft:"30px"},children:["Uploaded: ",xe]}),(0,M.jsx)("input",{type:"file",accept:".xlsx",ref:We,onChange:Ue,style:{display:"none"}})]})]})})]})]}),(0,M.jsx)(A.A,{span:24,children:(0,M.jsx)(_.A,{className:"roleAssignList",dataSource:(null===re||void 0===re?void 0:re.roles)||[],renderItem:(e,n)=>{var t,s,o,i,a,c,d,p,v,f,g,x,y,A,b,w,L,P,O;if(!He(e))return re.enableOrder?(0,M.jsxs)(r.A,{id:e.name,index:n,style:{cursor:"move"},moveList:Xe,children:[(0,M.jsxs)(_.A.Item,{actions:[(0,M.jsx)(l.A,{placeholder:"common.searchUser",contacts:re.contacts||[],setContacts:e=>{ae((n=>({...n,contacts:e})))},loading:re.cLoading,value:null===e||void 0===e||null===(t=e.user)||void 0===t?void 0:t.email,onChange:(e,t)=>{const s=[...re.roles];s[n].user=t,ae((e=>({...e,roles:s})))},visible:H,sProps:{bordered:!1,optionLabelProp:"label",allowClear:!0,dropdownMatchSelectWidth:!1,style:{minWidth:100}}})],children:[(0,M.jsxs)("b",{children:["#",n+1,"\xa0\xa0"]}),(0,M.jsx)(_.A.Item.Meta,{avatar:(0,M.jsx)(C.A,{style:{border:"1px solid rgba(".concat(e.color,", 0.5)"),backgroundColor:"rgba(".concat(e.color,", 0.1)"),color:"rgb(".concat(e.color,")")},children:e.name.charAt(0).toUpperCase()}),title:(0,M.jsx)("span",{className:"fw550",children:e.name})})]}),(0,M.jsx)(h.A,{disabled:!(null!==(s=re.roles[n].user)&&void 0!==s&&s.email),placeholder:(0,M.jsx)(u.A,{id:"common.setSecurity"}),allowClear:!0,bordered:!1,value:null===(o=re.roles[n].user)||void 0===o?void 0:o.securty_type,onChange:e=>{const t=[...re.roles];t[n].user&&(t[n].user.security_type=e),t[n].is_guest&&(t[n].is_guest=(0,F.find)(re.contacts,(e=>null===e||void 0===e?void 0:e.is_guest))),ae((e=>({...e,roles:t})))},getPopupContainer:()=>document.body,children:(0,F.map)(null!==(i=re.roles[n])&&void 0!==i&&null!==(a=i.user)&&void 0!==a&&a.is_guest?{...m.q6}:{...m.XK,...m.q6},((e,n)=>"password"===n?null:(0,M.jsx)(U,{children:e.title&&(0,M.jsx)(u.A,{id:e.title})},n)))})]},e.name):(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(_.A.Item,{actions:[(0,M.jsx)(l.A,{placeholder:"common.searchUser",contacts:re.contacts||[],setContacts:e=>{ae((n=>({...n,contacts:e})))},loading:re.cLoading,value:null===e||void 0===e||null===(c=e.user)||void 0===c?void 0:c.email,onChange:(e,t)=>{const s=[...re.roles];s[n].user=t,ae((e=>({...e,roles:s})))},visible:H,sProps:{bordered:!1,optionLabelProp:"label",allowClear:!0,dropdownMatchSelectWidth:!1,style:{minWidth:100}}})],children:(0,M.jsx)(_.A.Item.Meta,{avatar:(0,M.jsx)(C.A,{style:{border:"1px solid rgba(".concat(e.color,", 0.5)"),backgroundColor:"rgba(".concat(e.color,", 0.1)"),color:"rgb(".concat(e.color,")")},children:e.name.charAt(0).toUpperCase()}),title:(0,M.jsx)("span",{className:"fw550",children:e.name})})}),(0,M.jsx)(h.A,{disabled:!(null!==(d=re.roles[n].user)&&void 0!==d&&d.email),placeholder:(0,M.jsx)(u.A,{id:"common.setSecurity"}),allowClear:!0,bordered:!1,value:null===(p=re.roles[n].user)||void 0===p?void 0:p.security_type,onChange:e=>{const t=[...re.roles];t[n].user&&(t[n].user.security_type=e),t[n].is_guest&&(t[n].is_guest=(0,F.find)(re.contacts,(e=>null===e||void 0===e?void 0:e.is_guest))),"sms_security"===e&&(t[n].user.number_fill_by="recipient"),ae((e=>({...e,roles:t})))},getPopupContainer:()=>document.body,style:{minWidth:190,textAlign:"left"},children:(0,F.map)(null!==(v=re.roles[n])&&void 0!==v&&null!==(f=v.user)&&void 0!==f&&f.is_guest?{...m.q6}:{...m.XK,...m.q6},((e,n)=>"password"===n?null:(0,M.jsx)(U,{children:e.title&&(0,M.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,M.jsx)(u.A,{id:e.title}),"SMS"!==e.title&&ne?$e:null]})},n)))}),"sms_security"===(null===(g=re.roles[n].user)||void 0===g?void 0:g.security_type)&&(0,M.jsx)("div",{children:(0,M.jsx)(S.Ay.Group,{onChange:e=>{const t=[...re.roles],{user:s}=t[n];s.number_fill_by=e.target.value,s.sms_country="contact"===e.target.value?null===s||void 0===s?void 0:s.country:"",s.sms_phone_no="contact"===e.target.value?null===s||void 0===s?void 0:s.phone_number:"",ae((e=>({...e,roles:t})))},value:null===(x=re.roles[n].user)||void 0===x?void 0:x.number_fill_by,children:(0,M.jsxs)(k.A,{direction:"vertical",children:[(0,M.jsxs)(S.Ay,{value:"contact",disabled:!(null!==re&&void 0!==re&&null!==(y=re.roles[n])&&void 0!==y&&null!==(A=y.user)&&void 0!==A&&A.phone_number),children:[(0,M.jsx)(u.A,{id:"security.contactNumber"}),(0,M.jsx)("strong",{children:(null===re||void 0===re||null===(b=re.roles[n])||void 0===b?void 0:b.user)&&"- ".concat((null===re||void 0===re||null===(w=re.roles[n])||void 0===w||null===(L=w.user)||void 0===L?void 0:L.country)||""," ").concat((null===(P=re.roles[n].user)||void 0===P?void 0:P.phone_number)||"")})]}),(0,M.jsx)(S.Ay,{value:"recipient",children:(0,M.jsx)(u.A,{id:"security.recipientNumber"})}),(0,M.jsx)(S.Ay,{value:"sender",children:(0,M.jsx)(u.A,{id:"security.useThisNumber"})})]})})}),"sender"===(null===(O=re.roles[n].user)||void 0===O?void 0:O.number_fill_by)&&(0,M.jsx)("div",{children:(0,M.jsx)(j.A,{onChange:e=>{const t=e.target.value,s=[...re.roles];s[n].user.sms_phone_no=t,ae((e=>({...e,roles:s})))},placeholder:"Phone no",type:"number",addonBefore:(0,M.jsx)(D.A,{keyType:"code",valType:"dial_code",className:"countryPicker",filterOption:E.Tk,showSearch:!0,dropDownCustom:!1,allCountries:!0,userVerification:!0,optionFilterProp:!0,defaultValue:re.country||"+44",onChange:e=>{const t=e,s=[...re.roles];s[n].user.sms_country=t,ae((e=>({...e,roles:s})))}}),value:re.phone_number})})]})}})}),(0,M.jsx)(b.A,{}),(0,M.jsx)(v.A.Item,{style:{marginTop:"15px"},name:"directory",rules:[{validator:Re}],children:(0,M.jsx)(O.A,{dData:{},hint:"documents.folderHint",onSelect:e=>we(e),visible:!0,height:200,selected:be})}),(0,M.jsxs)(A.A,{span:24,children:[(0,M.jsx)("br",{}),(0,M.jsx)(L.A,{checked:!(null===re||void 0===re||null===(s=re.roles)||void 0===s||!s.find((e=>{var n;return["fromcsv"].includes(null===e||void 0===e||null===(n=e.email)||void 0===n?void 0:n.toLowerCase())})))||ue,onChange:e=>{const{checked:n}=e.target;me(n)},disabled:(null===re||void 0===re||null===(p=re.roles)||void 0===p?void 0:p.find((e=>{var n;return["fromcsv"].includes(null===e||void 0===e||null===(n=e.email)||void 0===n?void 0:n.toLowerCase())})))||ce&&ue,children:"Mark as completed"})]})]})]})})})}()})})}},13771:(e,n,t)=>{t.d(n,{A:()=>f});var s=t(41893),o=t(37734),i=t(6819),l=t(35676),r=t(68265),a=t(41135),c=t(87094),d=t(41988),u=t(55902),m=t(9950),p=t(94885),h=t(8187),v=t(44414);const f=function(e){const{visible:n,onClose:t,handleSubmit:f,modalData:g={}}=e,x=g||{},[y]=r.A.useForm(),[A,j]=(0,m.useState)(!1);(0,l.A)({form:y,visible:n,initVal:{is_selected:!1}});const b=(0,v.jsx)(r.A.Item,{name:"country",className:"countryFormItem",style:{marginBottom:0},children:(0,v.jsx)(p.A,{keyType:"code",valType:"dial_code",className:"countryPicker",filterOption:h.Tk,showSearch:!0,dropDownCustom:!1,allCountries:!0,userVerification:!0,optionFilterProp:!0})});return(0,v.jsx)(a.A,{title:(0,v.jsx)(o.A,{id:x.title||"documents.addRecipient"}),open:n,okText:(0,v.jsx)(o.A,{id:"common.submit"}),onCancel:A?null:t,onOk:A?null:function(){y.validateFields().then((e=>{!async function(e){j(!0);try{const n=new FormData;n.append("email",e.email),n.append("first_name",e.first_name),n.append("phone_number",e.phone_number);const t=await(0,i.Ay)("contact/create",n,"POST",void 0,!0);t.success?((0,s.A)("success",t.message),f(e)):(0,s.A)("error",t.message),j(!1)}catch(n){j(!1),(0,s.A)("error")}}(e)}))},okButtonProps:{id:"add-user"},confirmLoading:A,children:(0,v.jsx)(r.A,{form:y,layout:"vertical",children:(0,v.jsxs)(c.A,{gutter:6,children:[(0,v.jsx)(d.A,{span:24,children:(0,v.jsx)(r.A.Item,{label:(0,v.jsx)(o.A,{id:"common.fullName"}),name:"first_name",rules:[{required:!0,message:(0,v.jsx)(o.A,{id:"req.name"})},{max:50,message:(0,v.jsx)(o.A,{id:"err.max.50char"})},{whitespace:!0,message:(0,v.jsx)(o.A,{id:"err.blankSpace"})}],children:(0,v.jsx)(u.A,{})})}),(0,v.jsx)(d.A,{span:24,children:(0,v.jsx)(r.A.Item,{label:(0,v.jsx)(o.A,{id:"antTable.title.email"}),name:"email",rules:[{required:!0,message:(0,v.jsx)(o.A,{id:"req.email"})},{type:"email",message:(0,v.jsx)(o.A,{id:"err.email"})},{max:255,message:(0,v.jsx)(o.A,{id:"err.max.255char"})}],children:(0,v.jsx)(u.A,{})})}),(0,v.jsx)(d.A,{span:24,children:(0,v.jsx)(r.A.Item,{label:(0,v.jsx)(o.A,{id:"common.phoneNo"}),name:"phone_number",rules:[{max:15,message:(0,v.jsx)(o.A,{id:"err.max.15char"})},{whitespace:!0,message:(0,v.jsx)(o.A,{id:"err.blankSpace"})}],children:(0,v.jsx)(u.A,{type:"number",addonBefore:b})})})]})})})}}}]);