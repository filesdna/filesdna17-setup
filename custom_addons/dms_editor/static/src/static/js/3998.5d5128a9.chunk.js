"use strict";(self.webpackChunkfilesdna=self.webpackChunkfilesdna||[]).push([[3998],{21707:(e,i,s)=>{s.d(i,{A:()=>p});var n=s(44070);const t=s(73149).A;var r=s(41893),o=s(19392),c=s(37734),a=s(6819),l=s(41397),d=s(79796),u=s(44414);function p(e){const{apiUrl:i,apiData:s,title:p,fetchData:m=(()=>{}),setState:f=(()=>{}),onConfirm:y=(()=>{}),btnId:h,btnProps:x={},deleteCallback:g,disabled:v=!1}=e;return(0,u.jsx)(d.A,{children:(0,u.jsx)(t,{title:p,okText:(0,u.jsx)(c.A,{id:"common.deleteCap"}),okButtonProps:{id:"delete-item"},cancelText:(0,u.jsx)(c.A,{id:"common.no"}),onConfirm:async function(){if((0,l.isObject)(s)&&!(0,l.isEmpty)(s)){f((e=>({...e,loading:!0})));try{(new FormData).append("id",s.document_id),console.log(s);let e=await(0,a.Ay)(i,{params:s},"POST",{...a.$K,"Content-Type":"application/json"});e="form"===s.type?e.data:e.result;let n="error";e.success?(g&&g(),n="success",m()):f((e=>({...e,loading:!1}))),setTimeout((()=>{(0,r.A)(n,e.message)}),200)}catch(e){f((e=>({...e,loading:!1}))),(0,r.A)("error")}}else y()},className:"deleteBtn",onCancel:null,placement:"topRight",disabled:v,children:(0,u.jsx)("div",{children:(0,u.jsx)(o.A,{id:h,shape:"circle",danger:!0,icon:(0,u.jsx)(n.A,{}),className:"deleteCircle ".concat(v?" disabled":""),...x})})})})}},17619:(e,i,s)=>{s.d(i,{A:()=>o});var n,t=s(57528),r=s(33753);const o=(0,s(73053).A)(r.Ay.div(n||(n=(0,t.A)(["\n  @keyframes voice_pulse {\n    0% {\n      box-shadow: 0px 0px 5px 0px rgba(214, 214, 214, 0.7);\n    }\n    65% {\n      box-shadow: 0px 0px 5px 13px rgba(214, 214, 214, 0.9);\n    }\n    90% {\n      box-shadow: 0px 0px 5px 13px rgba(214, 214, 214, 0);\n    }\n  }\n\n  & .ant-btn-circle.rec {\n    animation-name: voice_pulse;\n    animation-duration: 1.5s;\n    animation-iteration-count: infinite;\n    animation-timing-function: linear;\n\n    background-color: #ff4646;\n    color: #fff;\n    border-color: transparent !important;\n  }\n"]))))},56884:(e,i,s)=>{s.d(i,{A:()=>n});const n=s(68265).A},93998:(e,i,s)=>{s.r(i),s.d(i,{default:()=>Y});var n=s(2260),t=s(35821),r=s(10597),o=s(58769),c=s(41893),a=s(19392),l=s(56884),d=s(37734),u=s(44414);const p=[{id:1,title:"settings.googleTwoFactor",type:"two_factor"},{id:2,title:"settings.msTwoFactor",type:"two_factor_microsoft"},{id:3,title:"common.password",type:"classified"},{id:4,title:"settings.fingerprint",type:"finger_print"},{id:5,title:"settings.nfc",type:"nfc"},{id:6,title:"settings.6DigAuth",type:"six_digit"}];d.A,d.A,d.A,d.A,d.A,d.A;var m=s(59958),f=s(84790),y=s(68633),h=s(97736),x=s(35116),g=s(6819),v=s(8187),A=s(35676),j=s(41404),_=s(41988),b=s(15480),w=s(22748),k=s(53079),C=s(55902),S=s(72612),F=s(87094),T=s(31407),N=s(16360),O=s(41397),L=s(9950),P=s(94135),D=s(98341),E=s(42074),R=s(34845);const I=(0,v.cI)(4),V=["nfc","finger_print","six_digit"],U=["two_factor","two_factor_microsoft"],{setTempSecVerifyEnabled:K,setUserObj:q}=j.A,B={title:"settings.authenticate"},M={remove:{title:"documents.removeClassified"},confirm:{title:"documents.confirmPssdTitle",apiUrl:"files/check-classified",fileApiKey:"document_id",fileApiVal:"hash_url"},deleteDoc:{apiUrl:"trash/move-to-trash",fileApiKey:"document_id",title:"documents.dltDoc"},two_factor:{title:"settings.googleTwoFactor",apiUrl:"file/verify2Factor",pssdKey:"token"},two_factor_microsoft:{title:"settings.msTwoFactor",apiUrl:"file/verify2Factor",pssdKey:"token"},finger_print:B,nfc:B,six_digit:B,is_verify_voice:B,is_verify_liveness:B,classified:{title:"documents.confirmPssdTitle",apiUrl:"files/check-classified",fileApiKey:"document_id",fileApiVal:"hash_url"},is_sms_enabled:{title:"SMS Configurations",apiUrl:"sms/update-sms-alert-value"}},W={two_factor:{title:"settings.googleTwoFactor",apiUrl:"user/verify-login",pssdKey:"token"},two_factor_microsoft:{title:"settings.msTwoFactor",apiUrl:"user/verify-login",pssdKey:"token"},finger_print:B,nfc:B,six_digit:B,is_verify_voice:B,is_verify_liveness:B,is_verify_uaepass:B,classified:{title:"documents.confirmPssdTitle",apiUrl:"files/check-classified",fileApiKey:"document_id",fileApiVal:"hash_url"},is_sms_enabled:{title:"SMS Configurations",apiUrl:"sms/update-sms-alert-value"}};let H=null,z=0;const Y=function(e){var i;const{type:s="",handleSubmit:v=(()=>{}),visible:j=!1,temporaryVerify:B=!1,onClose:Y=(()=>{}),rowData:G={},modalProps:J={},docData:X,securityFor:$=""}=e,Q=(0,D.useDispatch)(),Z=(0,L.useRef)(null),ee=(0,D.useSelector)((e=>e.Auth.userData))||{},ie=ee.security_setting?JSON.parse(ee.security_setting):{},se=ee.user_id===G.user_id,ne=M[s]||{},te=W[s]||{},[re,oe]=(0,L.useState)(!1),[ce,ae]=(0,L.useState)({pssdLoading:!1,activeOption:!1,voiceFile:"",verifyPhoneModal:!1}),{activeOption:le}=ce,de=e=>V.indexOf(e)>-1,[ue]=l.A.useForm();async function pe(e){oe(!0);const i="set"===s?"set-security-type":"remove-security-type",n="verify-login"===$?te.apiUrl:ne.apiUrl||"file/".concat(i);try{const i=await(0,g.Ay)(n,e,"POST");if(i.success)return oe(!1),(0,c.A)("success",i.message),v(i.data||{}),i;oe(!1),(0,c.A)("error",i.message)}catch(t){oe(!1),(0,c.A)("error")}}async function me(){ae((e=>({...e,pssdLoading:!0})));try{const e=await(0,g.Ay)("file/change-document-password",{hash_url:G.hash_url||""},"POST");e.success?(ae((e=>({...e,pssdLoading:!1}))),(0,c.A)("success",e.message)):(ae((e=>({...e,pssdLoading:!1}))),(0,c.A)("error",e.message))}catch(e){ae((e=>({...e,pssdLoading:!1}))),(0,c.A)("error")}}function fe(){z=0,clearTimeout(H)}async function ye(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";ae((e=>({...e,cancelLoading:!0})));try{const i=await(0,g.Ay)("verify-login"===$?"user/cancel-verify-device-for-login":"file/cancel-verify-device",{type:G.security_type||le,hash_url:G.hash_url,sign_url:G.sign_url,email:G.email},"POST");(0,c.A)("error","document.authCancelled"),i.success?(ae((e=>({...e,verifying:!1,cancelLoading:!1}))),"timeout"!==e&&setTimeout((()=>{he()}),300)):ae((e=>({...e,verifying:!1,cancelLoading:!1})))}catch(i){ae((e=>({...e,verifying:!1,cancelLoading:!1}))),(0,c.A)("error")}}function he(){"cancel"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")?(fe(),ye()):"set"===s?ae((e=>({...e,activeOption:!1}))):J&&(0,O.isFunction)(J.onCancel)&&J.onCancel()}async function xe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ae((e=>({...e,verifying:!0})));try{const i=await(0,g.Ay)("verify-login"===$?"user/check-unlock-status-for-login":"file/check-unlock-status",{action:G.action,security_type:G.security_type||le,hash_url:G.hash_url,sign_url:G.sign_url,email:G.email,...e},"POST"),n=i.error?"err.settings.".concat(i.error):"err.authFailed";i.success?(fe(),"remove"===s?pe({security_type:G.security_type||"",document_id:G.id||0}):"deleteDoc"===s?pe({document_id:G.id||0}):"set"===s?pe({security_type:le||"",document_id:G.id||0}):v(i),ae((e=>({...e,verifying:!1})))):z>5?(fe(),ae((e=>({...e,verifying:!1}))),ye("timeout")):i.verifying?(z+=1,H=setTimeout((()=>{xe(e)}),2e3)):(fe(),ae((e=>({...e,verifying:!1}))),(0,c.A)("error",n))}catch(i){fe(),ae((e=>({...e,verifying:!1}))),(0,c.A)("error")}}async function ge(){ae((e=>({...e,verifying:!0})));try{const e=await(0,g.Ay)("verify-login"===$?"user/verify-device-for-login":"file/verify-device",{action:G.action,security_type:G.security_type||le,hash_url:G.hash_url,sign_url:G.sign_url,type:s,email:G.email},"POST");e.success?(fe(),xe(e.data||{})):(ae((e=>({...e,verifying:!1}))),(0,c.A)("error"))}catch(e){ae((e=>({...e,verifying:!1}))),(0,c.A)("error")}}function ve(){ue.validateFields().then((async e=>{let i={...e},n=!0;"set"!==s||le||(n=!1,(0,c.A)("error","req.type")),"is_sms_enabled"!==le&&(i[ne.fileApiKey||"document_id"]=G[ne.fileApiVal||"id"]||0,i[ne.pssdKey||"password"]=i.doc_password||"0",i.security_type=le);if((U.indexOf(G.security_type)>-1||U.indexOf(le)>-1)&&(e.doc_password?6!==e.doc_password.length&&(n=!1,(0,c.A)("error","err.validConfirmCode")):(n=!1,(0,c.A)("error","req.confirmCode"))),"verify-login"===$){i={security_type:i.security_type,[ne.pssdKey||"password"]:i.doc_password||"0",email:G.email}}if(n){const e=await pe(i),s=(null===e||void 0===e?void 0:e.uData)||{};Q(q({...ee,...s}))}})).catch((e=>{console.log("Validate Failed:",e)}))}function Ae(e){ee[e.type||""]||0||"classified"===e.type?ae((i=>({...i,activeOption:e.type,secError:!1}))):ae((i=>({...i,secError:e.type})))}function je(){"is_verify_voice"===G.security_type?async function(){let e=!0;if(ce.voiceFile||(e=!1,(0,c.A)("error","req.voiceMessage")),e){ae((e=>({...e,verifying:!0})));try{const e=new FormData;e.append("token","gloryvoicefootprint"),e.append("code",G.voiceCode),e.append("audio",ce.voiceFile);const i=await(0,g.Ay)("file/verify-voice",e,"POST",{},!0);i.success&&Number(i.confidence)>.8?v({voiceFile:ce.voiceFile,voiceCode:G.voiceCode}):(0,c.A)("error","voice.failedErr"),ae((e=>({...e,verifying:!1,voiceFile:null})))}catch(i){ae((e=>({...e,verifying:!1,voiceFile:null}))),(0,c.A)("error")}}}():"is_verify_liveness"===G.security_type&&Z.current&&Z.current.handleButton("verify")}function _e(){const e=ce.verifying;return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(a.A,{loading:ce.cancelLoading,onClick:()=>ce.cancelLoading?null:he(e?"cancel":""),children:J.cancelText||(0,u.jsx)(d.A,{id:"common.goBack"})},"goback"),(0,u.jsx)(a.A,{type:"primary",disabled:e,onClick:()=>je(),children:(0,u.jsx)(d.A,{id:"settings.verify"})},"verify")]})}function be(){const e=ce.verifying;return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(a.A,{loading:ce.cancelLoading,onClick:()=>ce.cancelLoading?null:he(e?"cancel":""),children:(0,u.jsx)(d.A,{id:"common.cancel"})},"goback"),(0,u.jsx)(a.A,{type:"primary",onClick:()=>{Q(K(!0))},children:(0,u.jsx)(d.A,{id:"common.accept"})},"verify")]})}function we(){const e=ce.verifying;return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(a.A,{loading:ce.cancelLoading,onClick:()=>ce.cancelLoading?null:he(e?"cancel":""),children:J.cancelText||(0,u.jsx)(d.A,{id:"common.goBack"})},"goback"),(0,u.jsx)(a.A,{type:"primary",disabled:e,onClick:()=>ge(),children:(0,u.jsx)(d.A,{id:"settings.verify"})},"verify")]})}function ke(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"is_verify_voice"===e?(0,u.jsx)(h.A,{index:1,text:(0,u.jsx)(d.A,{id:"voice.verifyLine1",values:{code:(0,u.jsx)("span",{className:"fw550",children:G.voiceCode||""})}}),onSave:e=>{e&&ae((i=>({...i,voiceFile:e})))},clear:null===ce.voiceFile?"CLEAR":""}):"is_verify_liveness"===e?(0,u.jsx)(m.A,{ref:Z,type:"verify",isLivenessVerified:ee.is_verify_liveness&&0!==ee.is_verify_liveness,updateUserData:()=>v({verified:!0}),email:ee.email||"",cancelLoading:(null===ce||void 0===ce?void 0:ce.cancelLoading)||!1,goVerifyBack:he,verifyingDevice:ce.verifying||!1}):"is_verify_uaepass"===e?(0,u.jsx)(f.A,{redirectUrl:window.location.href}):null}function Ce(){const e=ce.verifying;return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(a.A,{loading:ce.cancelLoading,onClick:Y,children:(0,u.jsx)(d.A,{id:"common.cancel"})},"goback"),!(0,O.isEqual)(ee.sms_pack.sms_balance,0)&&(0,u.jsx)(a.A,{type:"primary",disabled:e,onClick:()=>ve(),style:{marginLeft:"5px"},children:(0,u.jsx)(d.A,{id:"Ok"})},"verify")]})}(0,A.A)({form:ue,visible:j,initVal:{lower_bound:(null===ee||void 0===ee||null===(i=ee.sms_pack)||void 0===i?void 0:i.lower_bound)||0}}),(0,L.useEffect)((()=>{!async function(){window.encoderRegistered||(await(0,T.kz)(await(0,N.Ng)()),window.encoderRegistered=!0)}()}),[]),(0,L.useEffect)((()=>{j?ae((e=>({...e,activeOption:G.security_type}))):(clearTimeout(H),ae((e=>({...e,activeOption:!1,voiceFile:null}))))}),[j]),(0,L.useEffect)((()=>{window.location.href.includes("code")&&(async()=>{const e=new URLSearchParams(window.location.search).get("code");if(console.log("code:",e),e)try{v({verified:!0}),console.log(window.location.href.split("&")[0]),await(0,g.Ay)("uae-pass/token",{code:e,redirect_url:window.location.href.split("&")[0]},"POST")}catch(i){console.error("Error fetching the token",i)}})()}),[]);const Se=(0,L.useCallback)((()=>{const e=(0,O.filter)(x.XK,((e,i)=>0===ee[i]));return(0,O.isArray)(e)&&!(0,O.isEmpty)(e)}),[ee])(),Fe=s&&"set"===s&&de(le)?null:J.footer;return(0,u.jsx)(r._H,{children:"sms_security"!==s?(0,u.jsx)(o.A,{visible:j,onClose:re?null:Y,title:B?(0,u.jsx)("div",{className:"bg-blue",children:(0,u.jsx)(d.A,{id:"Identity Verification"})}):(0,u.jsx)(d.A,{id:ne.title||"documents.classified"}),okText:(0,u.jsx)(d.A,{id:"common.submit"}),onOk:re?null:ve,onCancel:re?null:Y,confirmLoading:re,okButtonProps:{id:"create-password"},destroyOnClose:!0,footer:Fe,...J,children:(0,u.jsx)(R.hE,{children:(0,u.jsx)(S.A,{spinning:re,children:(0,u.jsx)(l.A,{autoComplete:"off",form:ue,layout:"vertical",onKeyPress:e=>{"Enter"!==e.key&&13!==e.charCode&&13!==e.which&&13!==e.keyCode||ve()},children:(0,u.jsxs)(F.A,{gutter:6,children:["set"===s&&!le&&Se&&(0,u.jsx)("div",{className:"mb20",children:(0,u.jsx)(_.A,{span:24,children:(0,u.jsx)(d.A,{id:"documents.classifiedHint",values:{link:(0,u.jsx)("a",{href:"/dashboard/security-settings","aria-label":"security setting",children:(0,u.jsx)(d.A,{id:"account.securitySetting"})})}})})}),(0,u.jsx)(_.A,{span:24,children:function(){const e="set"===s&&le?le:s,i=("remove"===s||"deleteDoc"===s)&&de(G.security_type),r=U.indexOf(G.security_type)>-1||U.indexOf(le)>-1,o="nfc"===G.security_type&&"security_settings"===G.action&&"set"===G.ssType;if(de(e)||i){const e=ce.verifying,i=e?"settings.verifying":"settings.verifyDevice",s=e?"settings.verifyingDevice":"settings.sentVerifyNoti";return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(k.Ay,{icon:e?(0,u.jsx)(n.A,{}):void 0,title:(0,u.jsx)(d.A,{id:i}),subTitle:o?(0,u.jsxs)("div",{className:"nfcContent",children:[(0,u.jsx)("p",{children:(0,u.jsx)(d.A,{id:"settings.nfcHint"})}),(0,u.jsx)("ol",{children:I.map(((e,i)=>(0,u.jsx)("li",{children:(0,u.jsx)(d.A,{id:"settings.nfcS".concat(i+1)})},i)))}),(0,u.jsx)("p",{children:(0,u.jsx)(d.A,{id:"settings.nfcReady"})})]}):(0,u.jsx)("p",{children:(0,u.jsx)(d.A,{id:s})}),extra:we()}),(0,u.jsx)(b.A,{className:"verifyAlert",message:(0,u.jsx)(d.A,{id:"settings.mobWarning"}),type:"info",closable:!1,showIcon:!0})]})}if(["classified","two_factor","two_factor_microsoft"].indexOf(le)>-1)return(0,u.jsxs)(u.Fragment,{children:["set"===s&&(0,u.jsx)(a.A,{className:"backBtn",type:"link",onClick:()=>{ae((e=>({...e,activeOption:!1})))},icon:(0,u.jsx)(t.A,{}),children:(0,u.jsx)(d.A,{id:"common.goBack"})}),r?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("h3",{children:(0,u.jsx)(d.A,{id:"tfa.confirmCodeTitle"})}),(0,u.jsx)("p",{children:(0,u.jsx)(d.A,{id:"tfa.confirmCodeDesc",values:{app:"two_factor_microsoft"===le||"two_factor_microsoft"===G.security_type?"Microsoft":"Google"}})}),(0,u.jsx)("div",{className:"otpInputContainer",children:(0,u.jsx)(l.A.Item,{name:"doc_password",children:(0,u.jsx)(P.A,{numInputs:6,shouldAutoFocus:!0,isInputNum:!0,separator:"-",hasErrored:!1,errorStyle:"error",containerStyle:{justifyContent:"center"},inputStyle:"otpInputStyle"})})})]}):(0,u.jsx)(l.A.Item,{label:(0,u.jsx)(d.A,{id:"common.password"}),name:"doc_password",rules:[{required:!0,message:(0,u.jsx)(d.A,{id:"req.password"})},{max:50,message:(0,u.jsx)(d.A,{id:"err.max.50char"})},{whitespace:!0,message:(0,u.jsx)(d.A,{id:"err.blankSpace"})}],children:(0,u.jsx)(C.A.Password,{autoComplete:"new-password",onPressEnter:ve})})]});if("set"===s)return(0,u.jsx)("div",{className:"securityOptions",children:p.map((e=>{const i=e.type===le,s=1===ee[e.type||""],n=(0,O.isArray)(ie.opening_doc)?ie.opening_doc:[];return s&&n.indexOf(e.type)>-1||"classified"===e.type?(0,u.jsx)("div",{id:"security_".concat(e.id),className:"option ".concat(i?"active":""),tabIndex:-1,role:"button",onClick:()=>Ae(e),onKeyPress:()=>Ae(e),children:e.title&&(0,u.jsx)(d.A,{id:e.title})},e.id):null}))});if(x.q6[null===G||void 0===G?void 0:G.security_type]){const e=x.q6[null===G||void 0===G?void 0:G.security_type],i=(null===e||void 0===e?void 0:e.verifyData)||{};return B?(0,u.jsx)(k.Ay,{icon:null,title:i.title&&(0,u.jsx)(d.A,{id:i.title}),extra:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{className:"mb30",children:"is_verify_liveness"===G.security_type?(0,u.jsxs)("div",{children:[(0,u.jsx)("img",{src:"/dms_editor/static/src/images/facial-recognition.png",width:150,alt:"facial recognition"}),(0,u.jsx)("p",{className:"liveness-description",children:(0,u.jsx)(d.A,{id:"liveness.identityVerification"})})]}):"is_verify_voice"===G.security_type?(0,u.jsxs)("div",{children:[(0,u.jsx)("img",{src:"/dms_editor/static/src/images/voice-recognition.png",width:150,alt:"voice recognition"}),(0,u.jsx)("p",{children:(0,u.jsx)(d.A,{id:"voice.identityVerification"})})]}):null}),be()]})}):(0,u.jsx)(k.Ay,{icon:ce.verifying?(0,u.jsx)(n.A,{}):void 0,title:i.title&&(0,u.jsx)(d.A,{id:i.title}),subTitle:(0,u.jsx)("p",{children:i.subTxt&&(0,u.jsx)(d.A,{id:i.subTxt})}),extra:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{className:"mb30",children:ke(G.security_type)}),"is_verify_voice"===G.security_type&&_e()]})})}var c;return"is_sms_enabled"===s?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{className:"mb30",children:ee.sms_pack.sms_balance?(0,u.jsxs)("div",{children:[(0,u.jsx)(l.A.Item,{label:(0,u.jsx)(d.A,{id:"Set low SMS alert"}),name:"lower_bound",children:(0,u.jsx)(C.A,{type:"number",placeholder:"Alert on"})}),(0,u.jsxs)("p",{children:["Available SMS - ",(0,u.jsx)("b",{children:null===ee||void 0===ee||null===(c=ee.sms_pack)||void 0===c?void 0:c.sms_balance})]})]}):(0,u.jsxs)("div",{children:["You haven't sufficient SMS balance, Please buy a \xa0",(0,u.jsx)(E.N_,{to:"/dashboard/billing?bactive=products",children:(0,u.jsx)(d.A,{id:"SMS Pack"})}),"."]})}),(0,u.jsx)("div",{style:{float:"right"},children:Ce()})]}):null}()}),ce.secError?(0,u.jsx)(_.A,{xs:24,className:"mt10",children:(0,u.jsx)(b.A,{showIcon:!0,type:"error",closeText:(0,u.jsx)(d.A,{id:"common.enableNow"}),afterClose:()=>null,message:(0,u.jsx)(d.A,{id:"common.enableSetting"})})}):null,s&&"set"!==s&&se&&"classified"===le?(0,u.jsx)(_.A,{span:24,children:(0,u.jsxs)("div",{className:"mt5",children:[(0,u.jsx)(d.A,{id:"documents.forgotPssd"})," ",(0,u.jsx)(w.A,{title:(0,u.jsx)(d.A,{id:"documents.newPssdHint"}),placement:"bottom",children:(0,u.jsxs)("span",{tabIndex:-1,className:"primaryColor pointer",onClick:ce.pssdLoading?void 0:me,onKeyPress:ce.pssdLoading?void 0:me,role:"button",children:[(0,u.jsx)(d.A,{id:"common.clickHere"}),ce.pssdLoading&&(0,u.jsx)(n.A,{style:{marginLeft:5}})]})})]})}):null]})})})})}):(0,u.jsx)(y.A,{visible:le,onClose:e=>{e&&ae((e=>({...e,activeOption:!1})))},verifySuccess:()=>{v({verified:!0})},phoneCode:X.sms_country,phoneNumber:X.sms_phone_no,classified:!0,rowData:G,number_fill_by:X.number_fill_by,fileData:{document_id:X.file.id,is_share:X.isShare,user_email:ee.email}})})}},68633:(e,i,s)=>{s.d(i,{A:()=>w});var n,t=s(57528),r=s(10597),o=s(41893),c=s(94885),a=s(37734),l=s(51679),d=s(6819),u=s(8187),p=s(68265),m=s(47293),f=s(41988),y=s(41135),h=s(52160),x=s(87094),g=s(55902),v=s(41397),A=s(9950),j=s(94135),_=s(33753),b=s(44414);function w(e){let{visible:i,onClose:s,phoneCode:w,phoneNumber:k,verifySuccess:C=(()=>{}),classified:S,rowData:F,number_fill_by:T,fileData:N}=e;const[O]=p.A.useForm(),[L,P]=(0,A.useState)(!1),[D,E]=(0,A.useState)(!1),[R,I]=(0,A.useState)(!1),[V,U]=(0,A.useState)(""),[K,q]=(0,A.useState)(Date.now()+6e4),B=e=>{O.resetFields(),P(!1),U(""),s(e)},[M,W]=(0,A.useState)(""),[H,z]=(0,A.useState)(w||"+44"),{Countdown:Y}=m.A;async function G(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};E(!0);const s=S?"checkOtp"===e?"user/check-otp-for-file":"user/send-otp-for-file":"checkOtp"===e?"user/check-otp":"user/send-otp";try{S&&(i.hash_url=F.sign_url,i.fileData=N);const n=await(0,d.Ay)(s,i,"POST");n.success?(E(!1),(0,o.A)("success",n.message),"checkOtp"===e?(C(),B(S&&"openFile")):P(!0)):(E(!1),(0,o.A)("error",n.message))}catch(n){E(!1),(0,o.A)("error")}}function J(){O.validateFields().then((e=>{L?(e.phone_no=e.phone_no||M,G("checkOtp",e)):(W(e.phone_no),G("",e))})).catch((e=>{console.log("Validate Failed:",e)}))}const X=(0,v.find)(l,{dial_code:w||"+44"}),$=S?(0,b.jsx)(p.A.Item,{name:"phone_code",className:"countryFormItem",rules:[{required:!0,message:(0,b.jsx)(a.A,{id:"req.phone"})}],style:{marginBottom:0},children:(0,b.jsx)(c.A,{keyType:"code",valType:"dial_code",className:"countryPicker",filterOption:u.Tk,showSearch:!0,dropDownCustom:!1,allCountries:!0,userVerification:!0,optionFilterProp:!0,disabled:!S||S&&!(0,v.isEmpty)(k),onChange:e=>z(e)})}):(0,b.jsx)(c.A,{valType:"code",className:"countryPicker",filterOption:u.Tk,showSearch:!0,dropDownCustom:!1,allCountries:!0,userVerification:!0,optionFilterProp:!0,defaultValue:X.code||"GB",disabled:!0}),Q=(0,_.Ay)(f.A)(n||(n=(0,t.A)(["\n    .ant-form-item-control-input {\n      min-height: 30px !important;\n    }\n  "]))),Z=(()=>{let e=!1;return L&&V.length<=5&&(e=!0),e})();return(0,b.jsx)(y.A,{style:{top:50},bodyStyle:{background:L?"#f4f4f4":"#0000",padding:40},visible:i,onClose:B,title:(0,b.jsx)(a.A,{id:"settings.verifyPhone"}),okText:(0,b.jsx)(a.A,{id:"common.submit"}),onOk:J,onCancel:B,destroyOnClose:!0,closable:!0,footer:[(0,b.jsx)(h.Ay,{onClick:B,children:(0,b.jsx)(a.A,{id:"common.cancel"})},"back"),(0,b.jsx)(h.Ay,{type:"primary",onClick:J,disabled:Z,loading:D,children:(0,b.jsx)(a.A,{id:L?"settings.verify":"settings.next"})},"submit")],children:(0,b.jsxs)(r._H,{children:[["contact","sender"].includes(T)&&(0,b.jsx)("h4",{children:"To access this document, the document owner requires SMS authentication, so please check your mobile for the OTP."}),(0,b.jsx)(p.A,{form:O,layout:"vertical",initialValues:{phone_no:k,phone_code:w||"+44"},children:(0,b.jsx)(x.A,{gutter:[12,0],children:L?(0,b.jsxs)(f.A,{xs:24,sm:24,children:[(0,b.jsxs)("div",{className:"otpLabel",children:[(0,b.jsx)("h3",{style:{color:"#444",fontWeight:"bold"},children:(0,b.jsx)(a.A,{id:"common.otp"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)(a.A,{id:"common.otpDesc"})," ",(0,b.jsxs)("span",{className:"numberWrap",children:[w,k]})]})]}),(0,b.jsx)(p.A.Item,{name:"otp_code",children:(0,b.jsx)(j.A,{onChange:e=>{U(e)},numInputs:6,shouldAutoFocus:!0,isInputNum:!0,separator:"-",hasErrored:!1,errorStyle:"error",containerStyle:{justifyContent:"center"},inputStyle:"otpInputStyle"})}),(0,b.jsxs)("div",{className:"otpWrapper",children:[(0,b.jsx)("div",{className:"otpTxt",children:(0,b.jsx)(a.A,{id:"common.receiveOtp"})}),(0,b.jsx)("span",{className:R?"timerWrapper":"timerWrapperDisabled",onClick:R?async function(){R||E(!0);const e=S?"user/send-otp-for-file":"user/resend-otp",i={};try{S&&(i.hash_url=F.sign_url,i.phone_no=M,i.phone_code=H);const s=await(0,d.Ay)(e,i,"POST");s.success?(E(!1),I(!1),q(Date.now()+6e4),(0,o.A)("success",s.message)):(E(!1),(0,o.A)("error",s.message))}catch(s){E(!1),(0,o.A)("error")}}:null,style:{cursor:R?"pointer":"not-allowed"},children:(0,b.jsx)(Y,{format:"mm:ss",title:"Resend",value:K,onFinish:()=>{I(!0)},valueStyle:{display:"visible"}})})]})]}):(0,b.jsx)(Q,{xs:24,sm:24,children:(0,b.jsx)(p.A.Item,{name:"phone_no",label:(0,b.jsx)(a.A,{id:"common.phoneNo"}),width:"100%",rules:[{required:!0,message:(0,b.jsx)(a.A,{id:"req.phone"})}],children:(0,b.jsx)(g.A,{style:{width:"100%"},min:1,maxLength:15,type:"number",addonBefore:$,disabled:!S||S&&!(0,v.isEmpty)(k)})})})})})]})})}},55215:(e,i,s)=>{s.d(i,{A:()=>l,Y:()=>a});var n,t,r=s(57528),o=s(33753);const c=o.Ay.div(n||(n=(0,r.A)(["\n  & .titleContent {\n    margin-bottom: 15px;\n\n    p {\n      font-size: 13px;\n    }\n  }\n\n  & .enrollContent {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    margin-top: 15px;\n  }\n\n  & .mainBtn {\n    font-size: 15px !important;\n    margin-left: 5px;\n    margin-right: 5px;\n  }\n\n  & .resultContent {\n    & .ant-col {\n      text-align: center;\n\n      & h4 {\n        margin-bottom: 10px;\n      }\n\n      & .ant-alert {\n        width: 60%;\n        margin: 0 auto;\n      }\n    }\n  }\n\n  & .deleteVoice {\n    & p {\n      margin-bottom: 10px;\n    }\n  }\n"]))),a=o.Ay.div(t||(t=(0,r.A)(["\n  padding: 5px 10px 5px 15px;\n  background: #f2f2f2;\n  border: 1px solid #ccc;\n  border-radius: 5px;\n  margin: 0px 0px 10px 0px;\n\n  & .recordContent {\n    display: flex;\n    align-items: center;\n\n    & .form-check-label {\n      flex: 1;\n      display: flex;\n      align-items: center;\n      font-weight: 550;\n      padding-right: 10px;\n    }\n\n    & .recordAction {\n      display: flex;\n      align-items: center;\n\n      & > * {\n        margin-right: 5px;\n        &:last-child {\n          margin-right: 0px;\n        }\n      }\n    }\n  }\n"]))),l=c},97736:(e,i,s)=>{s.d(i,{A:()=>y});var n=s(9950),t=s(1635),r=s(55266),o=s(19392),c=s(39389),a=s(37734),l=s(41893),d=s(53047),u=s(21707),p=s(17619),m=s(55215),f=s(44414);const y=e=>{let{text:i,index:s,onSave:y,clear:h}=e;const[x,g]=(0,n.useState)(null),{start:v,stop:A,isRecording:j}=(0,c.s)((e=>{const i=new File([e],"audio_".concat(s,"_file.wav"),{type:e.type});y(i),g(window.URL.createObjectURL(e))}),(e=>{"NotAllowedError"===e.name&&(0,l.A)("error","record.permission")})),_=()=>{y(null),g(null)};return(0,n.useEffect)((()=>{"CLEAR"===h&&_()}),[h]),(0,f.jsxs)(m.Y,{children:[(0,f.jsxs)("div",{className:"recordContent",children:[(0,f.jsx)("p",{className:"form-check-label",children:i}),(0,f.jsxs)("div",{className:"recordAction",children:[!x&&(0,f.jsx)(d.A,{placement:"bottom",title:(0,f.jsx)(a.A,{id:"".concat(j?"common.stop":"record")}),children:(0,f.jsx)(p.A,{children:(0,f.jsx)(o.A,{className:j&&"rec",shape:"circle",onClick:j?A:v,danger:j,icon:j?(0,f.jsx)(t.A,{}):(0,f.jsx)(r.A,{})})})}),!!x&&(0,f.jsx)(d.A,{placement:"bottom",title:(0,f.jsx)(a.A,{id:"voice.deleteRec"}),children:(0,f.jsx)("div",{children:(0,f.jsx)(u.A,{onConfirm:_})})})]})]}),(0,f.jsx)("div",{className:"recordAudio",children:!!x&&(0,f.jsx)("audio",{src:x,controls:!0})})]})}},39389:(e,i,s)=>{s.d(i,{A:()=>a,s:()=>c});var n=s(9950),t=s(31407);const r={isRecording:!1,recorder:null,data:null,error:null},o=(e,i)=>{switch(i.type){case"start":case"stop":return{...e,isRecording:!1};case"startRecording":return{...e,isRecording:!0,recorder:i.payload.recorder};case"hasError":return{...e,isRecording:!1,error:i.payload.error};default:return e}},c=(e,i)=>{const[s,c]=(0,n.useReducer)(o,r),[a,l]=(0,n.useState)(0),d=i=>{let{data:s}=i;e(s)};return(0,n.useEffect)((()=>()=>{s.recorder&&s.recorder.removeEventListener("dataavailable",(()=>{}))}),[s.recorder]),{start:async()=>{try{if(s.isRecording)return;c({type:"start"}),l(0);const e=await navigator.mediaDevices.getUserMedia({audio:!0}),i=new t.VW(e,{mimeType:"audio/wav"});c({type:"startRecording",payload:{recorder:i}}),i.start(),i.addEventListener("dataavailable",d),s.error&&c({type:"hasError",payload:{error:null}})}catch(e){console.log("\ud83d\ude80 ~ state.error",e),i(e),c({type:"hasError",payload:{error:e}})}},stop:()=>{try{const{recorder:e}=s;c({type:"stop"}),e&&("inactive"!==e.state&&e.stop(),e.removeEventListener("dataavailable",d))}catch(e){i(e),c({type:"hasError",payload:{error:e}})}},recorder:s.recorder,isRecording:s.isRecording,error:s.error,countdown:a}},a=c}}]);