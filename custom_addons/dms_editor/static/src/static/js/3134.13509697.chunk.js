"use strict";(self.webpackChunkfilesdna=self.webpackChunkfilesdna||[]).push([[3134,3070],{12197:(e,t,n)=>{n.d(t,{A:()=>y});var i,o=n(9950),r=n(90101),a=n(1203),s=n(18469),c=n(98341),l=n(21270),d=n(37734),u=n(41397),m=n(98581),p=n(57528),f=n(33753),h=n(73053),g=n(1868);const A=(0,h.A)(f.Ay.div(i||(i=(0,p.A)(["\n  & .moveHome {\n    padding: 6px;\n    margin-bottom: 8px;\n    cursor: pointer;\n    transition: all 0.3s;\n\n    &:hover {\n      background-color: #f5f5f5;\n    }\n\n    &.selected {\n      background: ",";\n      color: #fff;\n    }\n\n    & p {\n      font-size: 15px;\n      & .anticon {\n        margin: ",";\n        font-size: 16px;\n      }\n    }\n  }\n\n  & .ant-tree {\n    & .ant-tree-list {\n      & .ant-tree-list-holder-inner {\n        overflow-x: auto;\n\n        & .ant-tree-treenode {\n          & .ant-tree-indent {\n            white-space: initial;\n          }\n        }\n      }\n\n      & .ant-tree-switcher,\n      & .ant-tree-iconEle {\n        height: 34px;\n        line-height: 34px;\n\n        & .anticon {\n          font-size: 13px;\n        }\n      }\n      & .ant-tree-iconEle {\n        & .anticon {\n          font-size: 18px;\n        }\n      }\n      & .ant-tree-node-content-wrapper {\n        min-height: 34px;\n        line-height: 34px;\n\n        & .ant-tree-title {\n          font-size: 15px;\n          font-weight: 500;\n          margin-left: 5px;\n        }\n      }\n    }\n  }\n"])),(0,g.palette)("primary",0),(e=>"rtl"===e["data-rtl"]?"0 25px 0 10px":"0 10px 0 0")));var v=n(44414);const{DirectoryTree:x}=r.A,y=e=>{const{visible:t=!1,onSelect:n=(()=>{}),height:i,selected:r=[],hint:p="",multiple:f=!1}=e,[h,g]=(0,o.useState)({loading:!1,data:[]}),y=(0,c.useSelector)((e=>e.Auth.userData)),w="undefined"!==typeof window?window.innerHeight:800,b=async e=>{if(!Array.isArray(e))return[];const t=e.map((async e=>{const t=e.is_sub?await(async e=>{const t={params:{login:y.email}};return(await s.A.post("".concat(m.A.apiDomain,"/api/attachments/file-sub-directories/").concat(e),t,{headers:{Accept:"application/json","Content-Type":"application/json"}})).data.result.directories||[]})(e.directory_id):[],n=await b(t);return{title:e.directory_name,key:e.directory_id.toString(),children:n}}));return Promise.all(t)};(0,o.useEffect)((()=>{if(t){const e=async()=>{const e=await(async()=>{const e={params:{login:y.email}};return(await s.A.post("".concat(m.A.apiDomain,"/api/attachments/file-directories"),e,{headers:{Accept:"application/json","Content-Type":"application/json"}})).data.result.directories||[]})(),t=await b(e);g({loading:!1,data:t})};g({loading:!0,data:[]}),e()}else n([])}),[t]);return(0,v.jsxs)(A,{children:[p&&(0,v.jsx)("p",{className:"mb20",children:(0,v.jsx)(d.A,{id:p})}),h.loading||(0,u.isEmpty)(h.data)?(0,v.jsx)(a.A,{description:(0,v.jsx)(d.A,{id:"documents.noDir"})}):(0,v.jsx)(l.A,{style:{height:i||w-Math.round(w/1.5)},children:(0,v.jsx)(x,{height:i,treeData:h.data,onSelect:e=>{const t=(0,u.isEqual)(e,r)?[]:e;n(t)},selectedKeys:r,multiple:f})})]})}},13070:(e,t,n)=>{n.r(t),n.d(t,{default:()=>h});var i=n(9950),o=n(72612),r=n(87094),a=n(41988),s=n(41893),c=n(6819),l=n(58769),d=n(37734),u=n(10597),m=n(41397),p=n(12197),f=n(44414);const h=function(e){const{handleSubmit:t=(()=>{}),visible:n=!1,onClose:h=(()=>{}),docId:g="",folderId:A="",type:v="",dData:x={}}=e,y="copy"===v,[w,b]=(0,i.useState)(!1),[j,S]=(0,i.useState)([]),[D,C]=(0,i.useState)(!1);(0,i.useEffect)((()=>{C(n)}),[n]);const k=y?"documents.copyto":"documents.moveto",V=y?"common.copy":"common.move",_=y?"copy-to":"move-to";return(0,f.jsx)(u._H,{children:(0,f.jsx)(l.A,{open:n,onClose:w?null:h,title:(0,f.jsx)(d.A,{id:k}),okText:(0,f.jsx)(d.A,{id:V}),onOk:w?null:function(){let e=!0;j&&!(0,m.isEmpty)(j)||y||(e=!1,(0,s.A)("error","req.folder")),e&&async function(){b(!0);const e=(0,m.isArray)(j)&&!(0,m.isEmpty)(j)?j.toString():"";if(g==(y?e||A:e))return console.log(g,y?e||A:e),(0,s.A)("error","Select other folder"),void b(!1);try{const n=y?"copy-document":"move-document",i=await(0,c.Ay)("file/".concat(n),{document_id:g,folder_id:y?e||A:e,form:"forms"===x.page},"POST");i.success?(b(!1),(0,s.A)("success",i.message),t()):(b(!1),(0,s.A)("error",i.message))}catch(n){b(!1),(0,s.A)("error")}}()},onCancel:w?null:h,confirmLoading:w,okButtonProps:{id:_},children:(0,f.jsx)(o.A,{spinning:w,children:(0,f.jsx)(r.A,{gutter:6,children:(0,f.jsx)(a.A,{span:24,children:(0,f.jsx)(p.A,{docId:g,dData:x,folderId:A||g,visible:D,onSelect:e=>S(e),selected:j,type:v,hint:y?"documents.folderCopyHint":""})})})})})})}},3134:(e,t,n)=>{n.r(t),n.d(t,{default:()=>T});var i=n(27379),o=n(41893),r=n(37734),a=n(45182),s=n(13070),c=n(51865),l=n(6819),d=n(41135),u=n(52160),m=n(9950),p=n(98341),f=n(18469),h=n(57871),g=n(58168);const A={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM653.3 424.6l52.2 52.2a8.01 8.01 0 01-4.7 13.6l-179.4 21c-5.1.6-9.5-3.7-8.9-8.9l21-179.4c.8-6.6 8.9-9.4 13.6-4.7l52.4 52.4 256.2-256.2c3.1-3.1 8.2-3.1 11.3 0l42.4 42.4c3.1 3.1 3.1 8.2 0 11.3L653.3 424.6z"}}]},name:"import",theme:"outlined"};var v=n(25085),x=function(e,t){return m.createElement(v.A,(0,g.A)({},e,{ref:t,icon:A}))};const y=m.forwardRef(x);const w={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M482.2 508.4L331.3 389c-3-2.4-7.3-.2-7.3 3.6V478H184V184h204v128c0 2.2 1.8 4 4 4h60c2.2 0 4-1.8 4-4V144c0-15.5-12.5-28-28-28H144c-15.5 0-28 12.5-28 28v736c0 15.5 12.5 28 28 28h284c15.5 0 28-12.5 28-28V712c0-2.2-1.8-4-4-4h-60c-2.2 0-4 1.8-4 4v128H184V546h140v85.4c0 3.8 4.4 6 7.3 3.6l150.9-119.4a4.5 4.5 0 000-7.2zM880 116H596c-15.5 0-28 12.5-28 28v168c0 2.2 1.8 4 4 4h60c2.2 0 4-1.8 4-4V184h204v294H700v-85.4c0-3.8-4.3-6-7.3-3.6l-151 119.4a4.52 4.52 0 000 7.1l151 119.5c2.9 2.3 7.3.2 7.3-3.6V546h140v294H636V712c0-2.2-1.8-4-4-4h-60c-2.2 0-4 1.8-4 4v168c0 15.5 12.5 28 28 28h284c15.5 0 28-12.5 28-28V144c0-15.5-12.5-28-28-28z"}}]},name:"merge-cells",theme:"outlined"};var b=function(e,t){return m.createElement(v.A,(0,g.A)({},e,{ref:t,icon:w}))};const j=m.forwardRef(b);var S=n(44070),D=n(13239),C=n(94118),k=n(74972),V=n(50753),_=n(29933),z=n(44414);const E=_.M.getState().Auth.userData,H=[{id:"move",title:"common.moveto",icon:(0,z.jsx)(y,{}),allow:(0,V.s)(E.privilege_type,E.permission,k.$P,E.role)},{id:"merge",title:"common.merge",icon:(0,z.jsx)(j,{}),allow:!0},{id:"delete",title:"trash.move",icon:(0,z.jsx)(S.A,{}),danger:!0,allow:(0,V.s)(E.privilege_type,E.permission,k.fB,E.role)},{divider:!0,allow:!0},{id:"select-all",title:"common.selectAll",icon:(0,z.jsx)(D.A,{}),allow:!0},{id:"un-select-all",title:"common.unselectAll",icon:(0,z.jsx)(C.A,{}),allow:!0}];var L,I=n(57528),O=n(33753);const P=(0,n(73053).A)(O.Ay.div(L||(L=(0,I.A)(["\n  margin-bottom: 14px;\n  display: flex;\n  flex-flow: row wrap;\n  position: absolute;\n  height: 0;\n  opacity: 0;\n  z-index: -1;\n  transition: all 0.3s;\n\n  &.visible {\n    position: static;\n    height: auto;\n    opacity: 1;\n    z-index: 1;\n  }\n\n  & button {\n    margin-right: 10px;\n    border-color: #d9d9d9;\n  }\n\n  & .divider {\n    margin: 0 20px 0 10px;\n    width: 1px;\n    background: #eee;\n  }\n"])))),{confirm:M}=d.A;const T=function(e){const{visible:t=!1,dData:n,selected:d,folderId:g,fetchData:A=(()=>{}),selectAllFiles:v=(()=>{}),setSelected:x=(()=>{}),files:y=[],secureShare:w}=e,[b,j]=(0,m.useState)({btnLoading:!1}),S=(0,p.useSelector)((e=>e.Auth.userData));function D(){!async function(){j((e=>({...e,btnLoading:"delete"})));try{let e;if("forms"===n.page){for(let t=0;t<d.length;t++){const n=new FormData;n.append("id",d[t]),n.append("is_trash",1),n.append("user",S.user_id),e=await f.A.post(h.D.host+h.D.updateForm,n)}e=e.data}else e=await(0,l.Ay)("trash/move-to-trash",{document_id:d},"POST");x([]),j((e=>({...e,btnLoading:!1})));let t="error";e.success&&(t="success",A()),(0,o.A)(t,e.message)}catch(e){j((e=>({...e,btnLoading:!1}))),(0,o.A)("error")}}()}function C(e){if("move"===e&&j((e=>({...e,moveVisible:"move"}))),"delete"===e){let e=!0,t="";if((0,c.pm)(y,(e=>d.indexOf(e.id)>-1&&(e.security_type?(t="err.deleteClassified",!0):"Preparing"===e.status?(t="document.preparingErr",!0):e.is_share?(t="document.sharedErr",!0):"Completed"!==e.status&&"Pending"!==e.status&&"Draft"!==e.status&&"Declined"!==e.status&&"Published"!==e.status&&"Unpublished"!==e.status?(t="document.trashError","Pending Owner"===e.status&&(t="document.trashOwnerError"),!0):t)))&&t&&"forms"!==n.page)return e=!1,void(0,o.A)("error",t);e&&D()}if("select-all"===e&&v(),"un-select-all"===e&&x([]),"merge"===e)if(2===d.length){let e=!0;if((0,c.pm)(y,(e=>d.indexOf(e.id)>-1&&"application/pdf"!==e.file_type)))return e=!1,void(0,o.A)("error","document.mergeHint");if((0,c.pm)(y,(e=>d.indexOf(e.id)>-1&&!!e.security_type)))return e=!1,void(0,o.A)("error","err.mergeClassified");e&&M({title:(0,a.A)("documents.mergeConfirm"),icon:(0,z.jsx)(i.A,{}),maskClosable:!0,okText:(0,a.A)("common.merge"),onOk(){!async function(){j((e=>({...e,btnLoading:"merge"})));try{const e=await(0,l.Ay)("file/merge-document",{document_id:d},"POST");let t="error";j((e=>({...e,btnLoading:!1}))),e.success&&(t="success",A()),(0,o.A)(t,e.message)}catch(e){j((e=>({...e,btnLoading:!1}))),(0,o.A)("error")}}()}})}else(0,o.A)("error","document.mergeHint")}return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(P,{className:t?"visible":"",children:H.filter((e=>"forms"!==n.page||!["move","merge"].includes(e.id))).map(((e,t)=>e.divider&&!w?(0,z.jsx)("div",{className:"divider"},t):w?["select-all","un-select-all"].includes(e.id)?(0,z.jsxs)(u.Ay,{loading:b.btnLoading===e.id,onClick:()=>b.btnLoading?null:C(e.id),icon:e.icon,danger:e.danger,children:[(0,z.jsx)(r.A,{id:e.title}),e.rIcon&&e.rIcon]},e.id):void 0:e.allow&&(0,z.jsxs)(u.Ay,{loading:b.btnLoading===e.id,onClick:()=>b.btnLoading?null:C(e.id),icon:e.icon,danger:e.danger,children:[(0,z.jsx)(r.A,{id:e.title}),e.rIcon&&e.rIcon]},e.id)))}),(0,z.jsx)(s.default,{type:b.moveVisible,dData:n,visible:!!b.moveVisible,onClose:()=>j((e=>({...e,moveVisible:!1}))),docId:d,folderId:g,handleSubmit:()=>{j((e=>({...e,moveVisible:!1}))),A()}})]})}},51865:(e,t,n)=>{n.d(t,{dY:()=>o,pm:()=>a,wf:()=>s,z8:()=>r});var i=n(41397);function o(e,t,n){const i=new Image;i.crossOrigin="Anonymous",i.onload=function(){const e=document.createElement("canvas"),i=e.getContext("2d");let o;e.height=this.naturalHeight,e.width=this.naturalWidth,i.drawImage(this,0,0),o=e.toDataURL(n),t(o)},i.src=e,(i.complete||void 0===i.complete)&&(i.src="data:image/gif;base64, R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",i.src=e)}function r(e,t){const n=t?e.length:0;for(let o=0;o<n;o+=1){const n=e[o]&&e[o].getObjects()||[],r=t?(0,i.find)(n,t):{};if(r)return r}return{}}function a(e,t){const n=t?e.length:0;let i=null;for(let o=0;o<n;o+=1){const n=e[o];if(t(n)&&n){i=n;break}}return i}function s(e){return[5,10,25,50,75,100,...e?[]:[150]]}},27379:(e,t,n)=>{n.d(t,{A:()=>c});var i=n(58168),o=n(9950);const r={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"};var a=n(25085),s=function(e,t){return o.createElement(a.A,(0,i.A)({},e,{ref:t,icon:r}))};const c=o.forwardRef(s)}}]);