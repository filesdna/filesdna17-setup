(self.webpackChunkfilesdna=self.webpackChunkfilesdna||[]).push([[8513],{85739:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>se});var l=a(9950),s=a(39401),n=a(718),i=a(22748),r=a(24893),c=a(10495),o=a(32858),d=a(45259),m=a(65059),h=a(92163),u=a(77028),p=a(32077),x=a(52160),j=a(23072),A=a(35398),y=a(68902),f=a(87094),g=a(41988),b=a(31598),v=a(27109),C=a(69398),D=a(7688),k=a(43858),F=a(42025),T=a(94500),Y=a(20735),S=a(98114),w=a(50198),H=a(44070),M=a(72906),I=a(88349),N=a(62755),E=a(3911),L=a(87210),B=a(25984),P=a(69466),z=a(59051),q=a.n(z),O=a(40538),U=a(41397),J=a(18469),R=a(57871),V=a(28278),G=a(82038),_=a(46411),K=a(98341),W=a(12547),Q=a(44414);const{ExcelFile:X}=G.Ay,{ExcelSheet:Z}=G.Ay.ExcelFile,{ExcelColumn:$}=G.Ay.ExcelFile,{Paragraph:ee,Text:te}=s.A,{Sider:ae,Content:le}=n.A;function se(e){const{submissions:t}=e,[a,z]=(0,l.useState)(t),[G,se]=(0,l.useState)([]),[ne,ie]=(0,l.useState)(0),[re,ce]=(0,l.useState)("submissions"),[oe,de]=(0,l.useState)(!1),[me,he]=(0,l.useState)(a.filter((e=>0===e.status)).length>0?a.filter((e=>0===e.status))[0]:null),[ue,pe]=(0,l.useState)(!1),[xe,je]=(0,l.useState)({}),Ae=(0,K.useDispatch)(),{changeDocumentId:ye}=W.A,fe=["Inbox","Archive","Trash"],ge=["#3366CC","#FF9900","#DC3912","#8B0707","#AAAA11","#0099C6","#109618","#3B3EAC","#16D620","#990099"],be=[{value:"ColumnChart",label:(0,Q.jsx)(i.A,{title:"ColumnChart",children:(0,Q.jsx)(b.A,{})})},{value:"LineChart",label:(0,Q.jsx)(i.A,{title:"LineChart",children:(0,Q.jsx)(v.A,{})})},{value:"PieChart",label:(0,Q.jsx)(i.A,{title:"PieChart",children:(0,Q.jsx)(C.A,{})})},{value:"AreaChart",label:(0,Q.jsx)(i.A,{title:"AreaChart",children:(0,Q.jsx)(D.A,{})})}],ve=e=>{const{value:t,type:a}=e;return t?"appointment"===a?"".concat(t[0]?q()(t[0]).format(e.dateFormat||"DD/MM/YYYY"):""," \n              ").concat(t[1]?t[1]:""):"datePicker"===a?"".concat(t[0]?q()(t[0]).format(e.format||"DD/MM/YYYY"):""," \n              ").concat(t[1]?q()(t[1]).format(e.timeFormat||"HH:mm"):""):"time"===a?(0,U.isArray)(t)?"".concat(q()(t[0]).format(e.timeFormat||"HH:mm")," - ").concat(q()(t[1]).format(e.timeFormat||"HH:mm")):q()(t).format(e.timeFormat||"HH:mm"):"fullname"===a||"phone"===a?t.join(" "):"address"===a?t.join(", "):"signature"===a?(0,Q.jsx)("img",{src:t[0],width:t[1],alt:"filesdna-sign"}):"imageSelect"===a?(0,Q.jsx)("img",{src:t,alt:"filesdna-img",width:100}):"multipleChoice"===a?t.join(","):"fileUpload"===a?(0,Q.jsx)(Q.Fragment,{children:t.map((e=>(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(k.A,{})," ",(0,Q.jsx)("a",{href:e.url,target:"_blank",rel:"noreferrer",children:e.name}),(0,Q.jsx)("br",{})]})))}):"inputTable"===a?(0,Q.jsxs)("table",{className:"submission-table",children:[(0,Q.jsxs)("tr",{children:[(0,Q.jsx)("td",{className:"empty","aria-label":"title"}),t.cols.split("\n").map((e=>(0,Q.jsx)("td",{className:"title",children:e})))]}),t.rows.split("\n").map((e=>(0,Q.jsxs)("tr",{children:[(0,Q.jsx)("td",{className:"title",children:e}),t.cols.split("\n").map((a=>(0,Q.jsx)("td",{children:1===t.inputType?(0,Q.jsx)(r.Ay,{checked:void 0!==t.value&&void 0!==t.value[e]&&t.value[e]===a}):2===t.inputType?(0,Q.jsx)(c.A,{checked:void 0!==t.value&&void 0!==t.value[e]&&t.value[e].includes(a)}):void 0!==t.value&&void 0!==t.value[e]?t.value[e][a]:""})))]})))]}):(0,B.Ay)(String(t).replace("undefined",0)):""};const Ce=e=>{const{value:t,type:a}=e;if(!t)return"";if("appointment"===a)return"".concat(t[0]?q()(t[0]).format(e.dateFormat||"DD/MM/YYYY"):""," \n              ").concat(t[1]?t[1]:"");if("datePicker"===a)return"".concat(t[0]?q()(t[0]).format(e.format||"DD/MM/YYYY"):""," \n              ").concat(t[1]?q()(t[1]).format(e.timeFormat||"HH:mm"):"");if("time"===a)return(0,U.isArray)(t)?"".concat(q()(t[0]).format(e.timeFormat||"HH:mm")," - ").concat(q()(t[1]).format(e.timeFormat||"HH:mm")):q()(t).format(e.timeFormat||"HH:mm");if("fullname"===a||"phone"===a)return t.join(" ");if("address"===a)return t.join(", ");if("signature"===a)return t[0];if("multipleChoice"===a)return t.join(",");if("fileUpload"===a)return t.map((e=>e.url)).join(", ");if("inputTable"===a){let e=" * | ".concat(t.cols.replaceAll("\n","|"),"\r\n");return e+=t.rows.split("\n").map((e=>"".concat(e,"|").concat(t.cols.split("\n").map((a=>{var l;return 1===t.inputType?t.value[e]===a:2===t.inputType?null===(l=t.value[e])||void 0===l?void 0:l.includes(a):t.value[e][a]})).join("|")))).join("\r\n"),e}return function(e){const t=document.createElement("DIV");return t.innerHTML=e,t.textContent||t.innerText||""}(t).replaceAll("undefined",0).replace(/\s\s+/g," ")},De=async(e,t)=>{try{const l={headers:{Accept:"application/json","Content-Type":"application/json"}},s=new FormData;s.append("ids",e),s.append("status",t);const n=await J.A.post("".concat(R.D.host).concat(R.D.updateSubmission),{params:{ids:e,status:null===t||void 0===t?void 0:t.toString()}},l);if(n.data.result.success){o.Ay.success(n.data.result.message);const l=(0,U.cloneDeep)(a);l.forEach((a=>{e.includes(a.id)&&(a.status=t)})),z(l),se(G.filter((t=>!e.includes(t))))}else o.Ay.error(n.data.result.message)}catch(l){console.log("error",l)}},ke=async e=>{try{const t=new FormData;t.append("ids",e);const l=await J.A.post("".concat(R.D.host).concat(R.D.deleteSubmission),t);if(l.data.success){o.Ay.success(l.data.message);let t=(0,U.cloneDeep)(a);t=t.filter((t=>!e.includes(t.id))),z(t),se(G.filter((t=>!e.includes(t))))}else o.Ay.error(l.data.message)}catch(t){console.log("error",t)}},Fe=()=>{let e=[{title:"Submission Date",key:"createdat"}];return a.filter((e=>G.includes(e.id))).forEach((t=>{const a=JSON.parse(t.data).map(((e,t)=>({title:"".concat(e.label?e.label:e.type,"(").concat(e.type,")-").concat(t),key:"".concat(e.label?e.label:e.type,"(").concat(e.type,")-").concat(t)})));e=e.concat(a)})),e=(0,U.uniqBy)(e,"key"),e},Te=()=>a.filter((e=>G.includes(e.id))).map((e=>{const t={createdat:q()(e.createdat).format("YYYY/MM/DD HH:mm:ss")};return JSON.parse(e.data).forEach(((e,a)=>{e.rtl?t["".concat((e.label?e.label:e.type).split("").reverse().join(""),"(").concat(e.type,")-").concat(a)]=Ce(e).split("").reverse().join(""):t["".concat(e.label?e.label:e.type,"(").concat(e.type,")-").concat(a)]=Ce(e)})),t})),Ye=()=>t.map((e=>{const t={createdat:q()(e.createdat).format("YYYY/MM/DD HH:mm:ss")};return JSON.parse(e.data).forEach(((e,a)=>{["inputTable","scaleRating","imageSelect","rangeNumber","starRating","dropdown","singleChoice","multipleChoice"].includes(e.type)&&(t["".concat(e.label?e.label:e.type,"(").concat(e.type,")-").concat(a)]=Ce(e))})),t})),Se=(e,t)=>{const a=e.map((e=>e[t]));let l=[["Data","Selected Count",{role:"style"}]];return l=l.concat((0,U.uniq)(a).sort(((e,t)=>parseFloat(e)-parseFloat(t))).map(((e,l)=>[e?t.includes("imageSelect")?"Image ".concat(l+1):t.includes("inputTable")?"TableData ".concat(l+1):e:"Unselected",a.filter((t=>t===e)).length,ge[a.filter((t=>t===e)).length-1]]))),l},we=(e,t)=>(0,Q.jsx)("div",{className:"image-select-label",style:{display:oe?"initial":"none"},children:(0,Q.jsx)(d.A,{direction:"vertical",children:(0,U.uniq)(e.map((e=>e[t]))).sort(((e,t)=>parseFloat(e)-parseFloat(t))).map(((e,t)=>(0,Q.jsx)("div",{children:(0,Q.jsx)("b",{children:e?(0,Q.jsxs)(Q.Fragment,{children:["Image ",t+1," : ",(0,Q.jsx)("img",{src:e,width:80,height:50})]}):""})})))})}),He=e=>(e=void 0===e?"No Table Data":"<table class='chart-table'><tr><td>".concat(e.replace(" * ","").replace(/(?:\r\n|\r|\n)/g,"</td></tr><tr><td>").replaceAll("|","</td><td>"),"</td></tr></table>"),(0,B.Ay)(e)),Me=(e,t)=>(0,Q.jsx)("div",{className:"image-select-label",style:{display:oe?"initial":"none"},children:(0,Q.jsx)(d.A,{direction:"vertical",children:(0,U.uniq)(e.map((e=>e[t]))).sort(((e,t)=>parseFloat(e)-parseFloat(t))).map(((e,t)=>(0,Q.jsx)(m.A,{content:He(e)||"No tabledata",trigger:"click",children:(0,Q.jsx)("b",{style:{cursor:"pointer"},children:e?"TableData ".concat(t+1):"Unselected"})})))})}),Ie=e=>(0,Q.jsx)("div",{className:"chart-type-select",style:{display:oe?"initial":"none"},children:(0,Q.jsx)(r.Ay.Group,{value:xe[e],onChange:t=>{je((a=>({...a,[e]:t.target.value})))},children:be.map((e=>(0,Q.jsx)(r.Ay.Button,{value:e.value,children:e.label})))})}),Ne=e=>({title:e,vAxis:{minValue:0,format:"0"},legend:"none",backgroundColor:"#f5f5f5",pieSliceText:"label"}),Ee=e=>(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(c.A,{style:{marginTop:"5px"},checked:(0,U.isEqual)(a.filter((t=>t.status===e)).map((e=>e.id)),G)&&G.length>0,onChange:t=>{t.target.checked?se(a.filter((t=>t.status===e)).map((e=>e.id))):se([])}}),G.length>0&&(0,Q.jsxs)(d.A,{style:{float:"right"},children:[2!==e&&(0,Q.jsx)(h.A,{overlay:ue?(0,Q.jsx)(Q.Fragment,{}):(0,Q.jsxs)(u.A,{children:[(0,Q.jsxs)(u.A.Item,{onClick:()=>(async e=>{pe(!0);try{const t=new FormData;t.append("ids",e);const a=await J.A.post("".concat(R.D.host).concat(R.D.exportPdf),t,{responseType:"blob"}),l=new Date,s=window.URL.createObjectURL(new Blob([a.data],{type:"application/zip"})),n=document.createElement("a");n.href=s,n.setAttribute("download","export-pdf-".concat(l.getTime(),".zip")),document.body.appendChild(n),n.click()}catch(t){console.log("error",t)}setTimeout((()=>{pe(!1)}),100)})(G),children:[(0,Q.jsx)(F.A,{})," Download As PDF"]},"0"),(0,Q.jsx)(u.A.Item,{onClick:()=>(async e=>{pe(!0),console.log(e),setTimeout((()=>{pe(!1)}),500)})(G),children:(0,Q.jsx)(X,{element:(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(T.A,{})," Download As Excel"]}),filename:"export-excel",children:(0,Q.jsx)(Z,{data:Te(),name:"Submissions",children:Fe().map((e=>(0,Q.jsx)($,{label:e.title,value:e.key})))})})},"1"),(0,Q.jsx)(u.A.Item,{onClick:()=>(async e=>{pe(!0),console.log(e),setTimeout((()=>{pe(!1)}),500)})(G),children:(0,Q.jsxs)(_.CSVLink,{data:Te(),filename:"export-csv.csv",className:"btn btn-primary",target:"_blank",children:[(0,Q.jsx)(Y.A,{})," Download As CSV"]})},"2")]}),placement:"bottom",arrow:!0,children:(0,Q.jsx)(p.A,{count:G.length,children:(0,Q.jsx)(x.Ay,{icon:(0,Q.jsx)(S.A,{}),disabled:ue,loading:ue,children:"Download"})})}),(0,Q.jsx)(h.A,{overlay:(0,Q.jsxs)(u.A,{children:[(0,Q.jsxs)(u.A.Item,{onClick:()=>De(G,0===e?1:0),children:[(0,Q.jsx)(w.A,{})," ",0===e?"Archive":"Move to Inbox"]},"0"),2===e?(0,Q.jsxs)(u.A.Item,{onClick:()=>ke(G),children:[(0,Q.jsx)(H.A,{})," Delete Permanently"]},"1"):(0,Q.jsxs)(u.A.Item,{onClick:()=>De(G,2),children:[(0,Q.jsx)(H.A,{})," Move to Trash"]},"1")]}),placement:"bottom",arrow:!0,children:(0,Q.jsx)(x.Ay,{icon:(0,Q.jsx)(M.A,{})})})]}),(0,Q.jsx)(j.A,{}),(0,Q.jsx)(A.A,{itemLayout:"horizontal",dataSource:a.filter((t=>t.status===e)),renderItem:(t,a)=>(0,Q.jsx)(A.A.Item,{children:(0,Q.jsx)(A.A.Item.Meta,{title:(0,Q.jsxs)(d.A,{children:[(0,Q.jsx)(c.A,{checked:G.includes(t.id),onChange:e=>{e.target.checked?se([...G.filter((e=>e!==t.id)),t.id]):se(G.filter((e=>e!==t.id)))}}),(0,Q.jsx)(h.A,{overlay:(0,Q.jsxs)(u.A,{children:[(0,Q.jsxs)(u.A.Item,{onClick:()=>De([t.id],0===e?1:0),children:[(0,Q.jsx)(w.A,{})," ",0===e?"Archive":"Move to Inbox"]},"0"),2===e?(0,Q.jsxs)(u.A.Item,{onClick:()=>ke([t.id]),children:[(0,Q.jsx)(H.A,{})," Delete Permanently"]},"1"):(0,Q.jsxs)(u.A.Item,{onClick:()=>De([t.id],2),children:[(0,Q.jsx)(H.A,{})," Move to Trash"]},"1")]}),trigger:["contextMenu"],children:(0,Q.jsxs)("span",{className:t.id===(null===me||void 0===me?void 0:me.id)?"active submission-list":"submission-list",onClick:()=>he(t),children:[a+1,"\xa0-\xa0",q()(t.createdat).format("DD/MM/YYYY HH:mm:ss")]})})]}),description:t.from?(0,Q.jsx)(ee,{ellipsis:!0,children:(0,Q.jsx)("small",{children:t.from})}):""})})})]}),Le=[{key:0,label:"Inbox",children:Ee(0)},{key:1,label:"Archive",children:Ee(1)},{key:2,label:"Trash",children:Ee(2)}];return(0,Q.jsxs)(n.A,{className:"smartform-container",children:["submissions"===re&&(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(P.ur,{style:{width:"300px",height:"calc( 100vh - 65px )"},children:(0,Q.jsxs)(ae,{children:[(0,Q.jsx)(x.Ay,{onClick:()=>{document.getElementById("root").setAttribute("data-path","/dashboard/forms"),Ae(ye("/dashboard/forms"))},children:"Back"}),(0,Q.jsx)(r.Ay.Group,{style:{marginLeft:"100px"},options:[{value:"submissions",label:(0,Q.jsx)(i.A,{title:"Submissions",children:(0,Q.jsx)(I.A,{})})},{value:"analyze",label:(0,Q.jsx)(i.A,{title:"Analyze",children:(0,Q.jsx)(N.A,{})})}],onChange:e=>{let{target:{value:t}}=e;return ce(t)},value:re,optionType:"button"}),(0,Q.jsx)(j.A,{}),(0,Q.jsx)(y.A,{defaultActiveKey:0,items:Le,onChange:e=>{se([]),ie(e);const t=a.filter((t=>t.status===e));he(t.length>0?t[0]:null)},centered:!0})]})}),a.filter((e=>e.status===ne)).length>0?(0,Q.jsxs)(le,{style:{padding:"50px"},children:[(0,Q.jsxs)(te,{style:{float:"right"},children:[(0,Q.jsx)(E.A,{})," ",q()(me.createdat).format("DD/MM/YYYY HH:mm:ss")," ",(0,Q.jsx)("br",{}),me.from?(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(L.A,{})," ",me.from," "]}):""]}),(0,Q.jsxs)("h2",{children:[fe[ne]," Data"]}),(0,Q.jsx)(j.A,{}),(0,Q.jsx)(d.A,{direction:"vertical",children:JSON.parse(me.data).map((e=>(0,Q.jsxs)(d.A,{children:[(0,Q.jsx)("div",{style:{minWidth:"400px",display:"inline-block",color:"gray"},children:(0,Q.jsxs)(s.A.Title,{level:5,children:[e.label," (",(0,Q.jsx)("i",{children:e.type}),")"]})}),(0,Q.jsx)("div",{children:(0,Q.jsx)(s.A.Title,{level:5,children:ve(e)})})]})))})]}):(0,Q.jsx)(le,{style:{padding:"50px"},children:(0,Q.jsxs)("h2",{style:{marginTop:"100px",textAlign:"center",color:"lightgray"},children:["No ",fe[ne]," Data"]})})]}),"analyze"===re&&(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsxs)("div",{style:{padding:"20px"},children:[(0,Q.jsx)(x.Ay,{onClick:()=>{document.getElementById("root").setAttribute("data-path","/dashboard/forms"),Ae(ye("/dashboard/forms"))},children:"Back"}),(0,Q.jsx)(r.Ay.Group,{style:{marginLeft:"100px"},options:[{value:"submissions",label:(0,Q.jsx)(i.A,{title:"Submissions",children:(0,Q.jsx)(I.A,{})})},{value:"analyze",label:(0,Q.jsx)(i.A,{title:"Analyze",children:(0,Q.jsx)(N.A,{})})}],onChange:e=>{let{target:{value:t}}=e;ce(t),se([]),ie(0);const l=a.filter((e=>0===e.status));he(l.length>0?l[0]:null)},value:re,optionType:"button"})]}),(0,Q.jsx)(f.A,{style:{overflow:"hidden"},children:(()=>{const e=Ye();let t=[];return e.length>0&&e.forEach((e=>t=t.concat(Object.keys(e)))),t=(0,U.uniq)(t),t=t.length>0?t.filter((e=>"createdat"!==e)):[],t})().map(((e,t)=>(0,Q.jsxs)(g.A,{md:12,style:{minHeight:"500px"},children:[(0,Q.jsx)(O.t1,{chartType:xe[e]||be[t%4].value,width:"100%",height:500,data:Se(Ye(),e),options:Ne(e),loader:(0,Q.jsx)(V.A,{}),className:"survey-chart",onLoad:()=>de(!0)}),e.includes("imageSelect")&&we(Ye(),e),e.includes("inputTable")&&Me(Ye(),e),Ie(e)]})))})]})]})}},10273:()=>{},18307:()=>{}}]);