"use strict";(self.webpackChunkfilesdna=self.webpackChunkfilesdna||[]).push([[6443],{12197:(e,t,n)=>{n.d(t,{A:()=>j});var a,s=n(9950),i=n(90101),o=n(1203),r=n(18469),l=n(98341),c=n(21270),d=n(37734),u=n(41397),m=n(98581),p=n(57528),h=n(33753),f=n(73053),x=n(1868);const A=(0,f.A)(h.Ay.div(a||(a=(0,p.A)(["\n  & .moveHome {\n    padding: 6px;\n    margin-bottom: 8px;\n    cursor: pointer;\n    transition: all 0.3s;\n\n    &:hover {\n      background-color: #f5f5f5;\n    }\n\n    &.selected {\n      background: ",";\n      color: #fff;\n    }\n\n    & p {\n      font-size: 15px;\n      & .anticon {\n        margin: ",";\n        font-size: 16px;\n      }\n    }\n  }\n\n  & .ant-tree {\n    & .ant-tree-list {\n      & .ant-tree-list-holder-inner {\n        overflow-x: auto;\n\n        & .ant-tree-treenode {\n          & .ant-tree-indent {\n            white-space: initial;\n          }\n        }\n      }\n\n      & .ant-tree-switcher,\n      & .ant-tree-iconEle {\n        height: 34px;\n        line-height: 34px;\n\n        & .anticon {\n          font-size: 13px;\n        }\n      }\n      & .ant-tree-iconEle {\n        & .anticon {\n          font-size: 18px;\n        }\n      }\n      & .ant-tree-node-content-wrapper {\n        min-height: 34px;\n        line-height: 34px;\n\n        & .ant-tree-title {\n          font-size: 15px;\n          font-weight: 500;\n          margin-left: 5px;\n        }\n      }\n    }\n  }\n"])),(0,x.palette)("primary",0),(e=>"rtl"===e["data-rtl"]?"0 25px 0 10px":"0 10px 0 0")));var g=n(44414);const{DirectoryTree:v}=i.A,j=e=>{const{visible:t=!1,onSelect:n=(()=>{}),height:a,selected:i=[],hint:p="",multiple:h=!1}=e,[f,x]=(0,s.useState)({loading:!1,data:[]}),j=(0,l.useSelector)((e=>e.Auth.userData)),y="undefined"!==typeof window?window.innerHeight:800,w=async e=>{if(!Array.isArray(e))return[];const t=e.map((async e=>{const t=e.is_sub?await(async e=>{const t={params:{login:j.email}};return(await r.A.post("".concat(m.A.apiDomain,"/api/attachments/file-sub-directories/").concat(e),t,{headers:{Accept:"application/json","Content-Type":"application/json"}})).data.result.directories||[]})(e.directory_id):[],n=await w(t);return{title:e.directory_name,key:e.directory_id.toString(),children:n}}));return Promise.all(t)};(0,s.useEffect)((()=>{if(t){const e=async()=>{const e=await(async()=>{const e={params:{login:j.email}};return(await r.A.post("".concat(m.A.apiDomain,"/api/attachments/file-directories"),e,{headers:{Accept:"application/json","Content-Type":"application/json"}})).data.result.directories||[]})(),t=await w(e);x({loading:!1,data:t})};x({loading:!0,data:[]}),e()}else n([])}),[t]);return(0,g.jsxs)(A,{children:[p&&(0,g.jsx)("p",{className:"mb20",children:(0,g.jsx)(d.A,{id:p})}),f.loading||(0,u.isEmpty)(f.data)?(0,g.jsx)(o.A,{description:(0,g.jsx)(d.A,{id:"documents.noDir"})}):(0,g.jsx)(c.A,{style:{height:a||y-Math.round(y/1.5)},children:(0,g.jsx)(v,{height:a,treeData:f.data,onSelect:e=>{const t=(0,u.isEqual)(e,i)?[]:e;n(t)},selectedKeys:i,multiple:h})})]})}},626:(e,t,n)=>{n.d(t,{A:()=>m});var a=n(37734),s=n(6819),i=n(99386),o=n(52160),r=n(72612),l=n(41397),c=n(9950),d=n(44414);const{Option:u}=i.A;const m=function(e){const{onChange:t=(()=>{}),onSelect:n=(()=>{}),onDeselect:m=(()=>{}),placeholder:p,apiData:h={},initVal:f,fullData:x=!1,allowClear:A=!0,disabled:g=!1,mode:v,vKey:j="",lKey:y="",value:w,refSelect:b,renderOption:S=null,addNew:D=!1,onClear:C=(()=>{}),onClick:_=(()=>{}),open:k,onFocus:E=(()=>{}),onBlur:F=(()=>{})}=e,[T,z]=(0,c.useState)({data:[],fetching:!1}),[P,q]=(0,c.useState)(!1);let N=0;const{fetching:B,data:L}=T,O=P?L:L.slice(0,10);(0,c.useEffect)((()=>{(0,l.isObject)(f)&&!(0,l.isEmpty)(f)&&z((e=>({...e,value:f})))}),[f]);const I=async()=>{const e=(0,l.isObject)(h)?h:{};try{const t=await(0,s.Ay)(e.apiUrl,{}),n=t&&(0,l.isArray)(t.data)?t.data:[];z((e=>({...e,data:n,fetching:!1})))}catch(t){z((e=>({...e,data:[],fetching:!1})))}};(0,c.useEffect)((()=>{I()}),[(0,l.isEmpty)(w)]);const H=(0,l.debounce)((async e=>{N+=1;const t=N,n=e?e.trim():"",a=n.length,i=(0,l.isObject)(h)?h:{};if(a>1&&!(0,l.isEmpty)(i)){z((e=>({...e,data:[],fetching:!0})));try{const e=await(0,s.Ay)(i.apiUrl,{[i.apiParam]:n,fullData:x||null}),a=e&&(0,l.isArray)(e.data)?e.data:[];if(t!==N)return;z((e=>({...e,data:a,fetching:!1})))}catch(o){z((e=>({...e,data:[],fetching:!1})))}}else z((e=>({...e,data:[]})))}),800),M=j||"id",K=y||"name",U=()=>q(!0),V=S||function(e){return(0,d.jsx)(u,{value:e[M],obj:e,children:e[K]},e[M])};return(0,d.jsxs)(i.A,{onChange:t,placeholder:p,ref:b,notFoundContent:B?(0,d.jsx)("div",{className:"flexCenter",children:(0,d.jsx)(r.A,{size:"small"})}):null,filterOption:!1,onSearch:H,style:{width:"100%"},allowClear:A,showSearch:!0,disabled:g,mode:v,onSelect:e=>{n(e),I()},onDeselect:m,value:w,onClear:C,onClick:_,open:k,onFocus:E,onBlur:F,children:[O.map(V),D?(0,d.jsx)(u,{children:(0,d.jsx)("p",{style:{fontWeight:550},children:(0,d.jsx)(a.A,{id:"common.addNew"})})},"new"):null,L.map(V).length>10&&!P&&(0,d.jsx)(u,{style:{direction:"rtl"},children:(0,d.jsx)(o.Ay,{type:"text",size:"small",onClick:U,children:(0,d.jsx)(a.A,{id:"common.showMore"})})},"show-more")]})}},96443:(e,t,n)=>{n.r(t),n.d(t,{default:()=>E});var a=n(8750),s=n(25928),i=n(2260),o=n(12197),r=n(41893),l=n(78254),c=n(37734),d=n(6819),u=n(68265),m=n(55902),p=n(23072),h=n(52160),f=n(87094),x=n(41988),A=n(53079),g=n(24893),v=n(41135),j=n(41397),y=n(9950),w=n(98341),b=n(18469),S=n(57871),D=n(626),C=n(12547),_=n(34845),k=n(44414);const E=function(e){var t,n,E,F;const{cFolderId:T,visible:z,onClose:P,dData:q={},handleSubmit:N}=e,B=(0,y.useRef)(null),L=(0,w.useSelector)((e=>e.Auth.access)),O=(0,w.useSelector)((e=>e.Auth.userData)),I=null===L||void 0===L?void 0:L.is_free_plan,H="Form"===(null===q||void 0===q||null===(t=q.apiData)||void 0===t?void 0:t.doc_type),M=null===O||void 0===O||null===(n=O.plan)||void 0===n||null===(E=n.currentPlan)||void 0===E||null===(F=E.features)||void 0===F?void 0:F.forms,[K,U]=(0,y.useState)(!1),[V,R]=(0,y.useState)("Form"),[G,W]=(0,y.useState)("portrait"),[J,Q]=(0,y.useState)([]),[X,Y]=(0,y.useState)(!1),Z=new URLSearchParams(window.location.search),$=()=>{let e=!1;var t;H?e=M&&I?0===(null===L||void 0===L||null===(t=L.monthly_features)||void 0===t?void 0:t.num_of_forms):I:(L.document_limit||I)&&(e=L.document_limit||I);return e},[ee]=u.A.useForm(),te=q&&q.apiData?q.apiData:{},[ne,ae]=(0,y.useState)(!1),[se,ie]=(0,y.useState)([]),[oe,re]=(0,y.useState)(!1),{changeDocumentId:le}=C.A,ce=(0,w.useDispatch)(),de=q&&"templates"===(null===q||void 0===q?void 0:q.page)?"Template":q&&"forms"===(null===q||void 0===q?void 0:q.page)?"Form":q&&"attachments"===(null===q||void 0===q?void 0:q.page)?"Attachment":"Document",ue="editor"!==(null===q||void 0===q?void 0:q.page);function me(){ee.validateFields().then((e=>{let t={...e};const n=(0,j.isEmpty)(se)?"":se.toString();t.folder_id=["Template","Attachment"].includes(de)&&"team"===O.role?n||"0":n||T||0,t.doc_type=de,t.file_type=e.file_type||"pdf",t.tags=J,!(0,j.isEmpty)(te)&&te.data&&(t={...t,...te.data}),async function(e){ae(!0);try{const a=await(0,d.Ay)(te.apiUrl||"file/create-document",{params:e},"POST");var t,n;a.result.success?(null!==q&&void 0!==q&&q.fillDoc&&(0,r.A)("success","document.fileCreateSucc"),(0,j.isFunction)(N)?N(e):(0,j.isString)(null===a||void 0===a||null===(t=a.result)||void 0===t?void 0:t.data)&&(0,j.isEmpty)(null===a||void 0===a||null===(n=a.result)||void 0===n?void 0:n.data)):(0,r.A)("error",a.result.message),setTimeout((()=>{ae(!1)}),500)}catch(a){ae(!1),(0,r.A)("error")}}(t)}))}async function pe(){ae(!0);const e=new FormData,t=(0,j.isEmpty)(se)?"":se.toString(),n=t||Z.get("folder_id")||0;console.log("Test value ==>> ",se,O.role,t,T,n,Z.get("folder_id")),e.append("name",V),e.append("type","form"),e.append("folder_id",n),e.append("user_id",O.user_id);try{const t=await b.A.post(S.D.host+S.D.createForm,e);!0===t.data.success?(document.getElementById("root").setAttribute("data-path","/smartform/".concat(t.data.data.hash)),ce(le("/smartform/".concat(t.data.data.hash)))):(0,r.A)("error",t.data.message)}catch(a){console.log(a)}ae(!1)}function he(e,t){if("add"===t){const t=e?e.toString().trim():"";if(t){const e=[...J];e.push(t),Q(e)}else(0,r.A)("error","err.tagBlank")}else if("remove"===t){const t=[...J],n=t.indexOf(e);n>-1&&(t.splice(n,1),Q(t))}}return(0,y.useEffect)((()=>{re(z),U(!1),z&&setTimeout((()=>{null!==B&&void 0!==B&&B.current&&B.current.focus()}),100)}),[z,se]),(0,k.jsx)(v.A,{title:(0,k.jsx)(c.A,{id:q.createTitle||"document.createDoc"}),open:z,onCancel:ne?null:P,onOk:me,confirmLoading:ne,okText:(0,k.jsx)(c.A,{id:"common.create"}),okButtonProps:{id:"create-new-doc"},footer:$()||"Form"===de?null:void 0,children:(0,k.jsx)(_.Ky,{children:$()?(0,k.jsx)(l.default,{msg:I?"upgrade.subTxt":"upgrade.reasonDoc"}):"Form"===de?K?(0,k.jsxs)("div",{style:{paddingTop:"20px"},children:[(0,k.jsx)("h3",{children:(0,k.jsx)(c.A,{id:"workflow.formName"})}),(0,k.jsx)("br",{}),(0,k.jsx)(m.A,{value:V,onChange:e=>R(e.target.value),onPressEnter:pe}),(0,k.jsx)(p.A,{}),(0,k.jsx)(h.Ay,{type:"primary",onClick:pe,disabled:ne,children:"Create"})]}):(0,k.jsxs)(f.A,{children:[(0,k.jsx)(x.A,{xs:12,className:"mb10",children:(0,k.jsxs)("div",{className:"createform",onClick:()=>U(!0),children:[(0,k.jsx)(a.A,{}),(0,k.jsx)("h3",{children:(0,k.jsx)("b",{children:"Create From Scratch"})}),(0,k.jsx)("p",{children:"A blank form is all you need"})]})}),(0,k.jsx)(x.A,{xs:12,className:"mb10",children:(0,k.jsxs)("div",{className:"createform",onClick:()=>{const e=((0,j.isEmpty)(se)?"":se.toString())||T||0;document.getElementById("root").setAttribute("data-path","/smartform/template/".concat(e)),ce(le("/smartform/template/".concat(e)))},children:[(0,k.jsx)(s.A,{}),(0,k.jsx)("h3",{children:(0,k.jsx)("b",{children:"Use Template"})}),(0,k.jsx)("p",{children:"Choose from premade forms"})]})})]}):ne?(0,k.jsx)(A.Ay,{icon:(0,k.jsx)(i.A,{}),title:(0,k.jsx)(c.A,{id:"document.creatingDoc"}),subTitle:(0,k.jsx)(c.A,{id:"document.creatingDocMsg"})}):(0,k.jsx)(u.A,{form:ee,initialValues:{file_type:"pdf",doc_view:G},layout:"vertical",children:(0,k.jsxs)(f.A,{children:[ue&&(0,k.jsx)(x.A,{xs:24,className:"mb10",children:(0,k.jsx)(u.A.Item,{name:"file_type",label:(0,k.jsx)("span",{className:"mb5",children:(0,k.jsx)(c.A,{id:"document.typeCreateDoc"})}),children:(0,k.jsx)(g.Ay.Group,{children:(0,k.jsx)(g.Ay.Button,{value:"pdf",children:"PDF"})})})}),(0,k.jsx)(x.A,{xs:24,children:(0,k.jsx)(u.A.Item,{name:"name",label:(0,k.jsx)(c.A,{id:"common.filename"}),rules:[{required:!0,message:(0,k.jsx)(c.A,{id:"req.name"})},{max:50,message:(0,k.jsx)(c.A,{id:"err.min.50char"})},{whitespace:!0,message:(0,k.jsx)(c.A,{id:"err.blankSpace"})}],children:(0,k.jsx)(m.A,{ref:B,onKeyPress:e=>{"Enter"!==e.key&&13!==e.keyCode||me()}})})}),(0,k.jsx)(p.A,{}),(0,k.jsx)(x.A,{xs:12,children:(0,k.jsx)(u.A.Item,{name:"doc_view",className:"exportFormItem",label:"Please select document view type",rules:[{required:!0,message:"Please select document view type"}],children:(0,k.jsxs)(g.Ay.Group,{size:"large",onChange:e=>{W(e.target.value)},value:G,children:[(0,k.jsx)(g.Ay,{id:"pdf-view",value:"portrait",children:"Portrait"}),(0,k.jsx)(g.Ay,{id:"pdf-view",value:"landscape",children:"Landscape"})]})})}),(0,k.jsxs)(x.A,{xs:12,style:{borderLeft:"2px dashed rgba(0, 151, 167, 0.4)",paddingLeft:"15px"},children:[(0,k.jsx)("h3",{style:{marginBottom:10,fontSize:"14px"},children:(0,k.jsx)(c.A,{id:"documents.searchTags"})}),(0,k.jsx)(D.A,{refSelect:null,mode:"tags",apiData:{apiParam:"keyword",apiUrl:"file/get-tags"},placeholder:(0,k.jsx)(c.A,{id:"documents.searchTags"}),vKey:"name",onSelect:e=>{"show-more"!==e&&he(e,"add")},onDeselect:e=>he(e,"remove"),value:J,onClear:()=>Q([]),open:X,onFocus:()=>Y(!0),onBlur:()=>Y(!1)})]}),(0,k.jsx)(p.A,{}),(0,k.jsx)(x.A,{span:24,children:(0,k.jsx)(o.A,{dData:q,hint:q.folderHint||"documents.folderHint",onSelect:e=>ie(e),visible:oe,height:200,selected:se})})]})})})})}},25928:(e,t,n)=>{n.d(t,{A:()=>l});var a=n(58168),s=n(9950);const i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 632H136v-39.9l138.5-164.3 150.1 178L658.1 489 888 761.6V792zm0-129.8L664.2 396.8c-3.2-3.8-9-3.8-12.2 0L424.6 666.4l-144-170.7c-3.2-3.8-9-3.8-12.2 0L136 652.7V232h752v430.2zM304 456a88 88 0 100-176 88 88 0 000 176zm0-116c15.5 0 28 12.5 28 28s-12.5 28-28 28-28-12.5-28-28 12.5-28 28-28z"}}]},name:"picture",theme:"outlined"};var o=n(25085),r=function(e,t){return s.createElement(o.A,(0,a.A)({},e,{ref:t,icon:i}))};const l=s.forwardRef(r)},8750:(e,t,n)=>{n.d(t,{A:()=>l});var a=n(58168),s=n(9950);const i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M482 152h60q8 0 8 8v704q0 8-8 8h-60q-8 0-8-8V160q0-8 8-8z"}},{tag:"path",attrs:{d:"M192 474h672q8 0 8 8v60q0 8-8 8H160q-8 0-8-8v-60q0-8 8-8z"}}]},name:"plus",theme:"outlined"};var o=n(25085),r=function(e,t){return s.createElement(o.A,(0,a.A)({},e,{ref:t,icon:i}))};const l=s.forwardRef(r)}}]);