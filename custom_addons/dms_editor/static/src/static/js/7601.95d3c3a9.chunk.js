"use strict";(self.webpackChunkfilesdna=self.webpackChunkfilesdna||[]).push([[7601],{6828:(e,a,s)=>{s.r(a),s.d(a,{default:()=>E});var t=s(43858),i=s(87210),n=s(3911),l=s(34373),o=s(10597),r=s(37734),c=s(12036),d=s(6819),m=s(39401),u=s(35621),h=s(52160),p=s(24893),x=s(10495),g=s(23072),j=s(45259),f=s(15480),v=s(87094),w=s(41988),y=s(55902),b=s(25984),A=s(98341),k=s(41397),C=s(59051),z=s.n(C),M=s(9950),Y=s(44414);const S=(0,M.lazy)((()=>Promise.all([s.e(1135),s.e(8265),s.e(9466),s.e(5398),s.e(9642),s.e(8902),s.e(3126),s.e(3073),s.e(4051),s.e(8334),s.e(9804)]).then(s.bind(s,78309)))),{Paragraph:D,Text:N}=m.A;function E(){const[e,a]=(0,M.useState)([]),[s,C]=(0,M.useState)(null),[E,_]=(0,M.useState)(!1),[T,H]=(0,M.useState)(null),[F,I]=(0,M.useState)(null),[L,K]=(0,M.useState)(null),{userData:V}=(0,A.useSelector)((e=>e.Auth)),[P,q]=(0,M.useState)({reassignLoading:!1,approveLoading:!1,loading:!0});async function O(){const e=await(0,d.Ay)("workflow/get-my-approvals");e&&e.data&&(a(e.data),q((e=>({...e,loading:!1}))))}(0,M.useEffect)((()=>{e.length<1&&O()}),[]);const R=[{key:"workflow",title:(0,Y.jsx)(r.A,{id:"workflow.projectName"}),dataIndex:"workflow",rowKey:"workflow",className:"fullname-cell",render:e=>e.name},{key:"createdAt_sort",title:(0,Y.jsx)(r.A,{id:"common.createdat"}),dataIndex:"createdat",rowKey:"createdat",width:180,render:e=>(0,Y.jsxs)("div",{children:[(0,Y.jsx)("span",{className:"label",children:(0,Y.jsx)(r.A,{id:"common.createdat"})}),(0,Y.jsx)("span",{className:"mobile-lbl-val",children:e?z()(e).format("lll"):"-"})]})},{key:"form",title:(0,Y.jsx)(r.A,{id:"workflow.formName"}),dataIndex:"form",rowKey:"form",className:"fullname-cell",render:e=>e.name},{key:"form",title:(0,Y.jsx)(r.A,{id:"workflow.submitter"}),dataIndex:"submission",rowKey:"submission",className:"fullname-cell",render:e=>e.from},{key:"status",title:(0,Y.jsx)(r.A,{id:"common.status"}),dataIndex:"status",rowKey:"status",width:150,render:e=>(0,Y.jsx)(u.A,{color:"pending"===e?"yellow":"Deny"===e?"red":"green",children:"pending"===e?"Waiting for Approve":e})},{title:(0,Y.jsx)(r.A,{id:"common.action"}),dataIndex:"edit",rowKey:"edit",width:200,fixed:"right",className:"action-cell",render:(e,a)=>(0,Y.jsx)(h.Ay,{type:"primary",style:{marginRight:"5px"},onClick:()=>C(a),children:"pending"===a.status?"Review & Approve":"View"})}],B=e=>{const{value:a,type:s}=e;return a?"appointment"===s?"".concat(a[0]?z()(a[0]).format(e.dateFormat||"DD/MM/YYYY"):""," \n              ").concat(a[1]?a[1]:""):"datePicker"===s?"".concat(a[0]?z()(a[0]).format(e.format||"DD/MM/YYYY"):""," \n              ").concat(a[1]?z()(a[1]).format(e.timeFormat||"HH:mm"):""):"time"===s?(0,k.isArray)(a)?"".concat(z()(a[0]).format(e.timeFormat||"HH:mm")," - ").concat(z()(a[1]).format(e.timeFormat||"HH:mm")):z()(a).format(e.timeFormat||"HH:mm"):"fullname"===s||"phone"===s?a.join(" "):"address"===s?a.join(", "):"signature"===s?(0,Y.jsx)("img",{src:a[0],width:a[1],alt:"filesdna-sign"}):"imageSelect"===s?(0,Y.jsx)("img",{src:a,alt:"filesdna-img",width:100}):"multipleChoice"===s?a.join(","):"fileUpload"===s?(0,Y.jsx)(Y.Fragment,{children:a.map((e=>(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(t.A,{})," ",(0,Y.jsx)("a",{href:e.url,target:"_blank",rel:"noreferrer",children:e.name}),(0,Y.jsx)("br",{})]})))}):"inputTable"===s?(0,Y.jsxs)("table",{className:"submission-table",children:[(0,Y.jsxs)("tr",{children:[(0,Y.jsx)("td",{className:"empty","aria-label":"title"}),a.cols.split("\n").map((e=>(0,Y.jsx)("td",{className:"title",children:e})))]}),a.rows.split("\n").map((e=>(0,Y.jsxs)("tr",{children:[(0,Y.jsx)("td",{className:"title",children:e}),a.cols.split("\n").map((s=>(0,Y.jsx)("td",{children:1===a.inputType?(0,Y.jsx)(p.Ay,{checked:void 0!==a.value&&void 0!==a.value[e]&&a.value[e]===s}):2===a.inputType?(0,Y.jsx)(x.A,{checked:void 0!==a.value&&void 0!==a.value[e]&&a.value[e].includes(s)}):void 0!==a.value&&void 0!==a.value[e]?a.value[e][s]:""})))]})))]}):(0,b.Ay)(String(a).replace("undefined",0)):""};return(0,Y.jsxs)(c.A,{children:[(0,Y.jsx)(o.az,{children:(0,Y.jsxs)(o.Ox,{children:[s&&(0,Y.jsx)(h.Ay,{onClick:()=>C(null),children:"Back"}),(0,Y.jsxs)("div",{className:"isoInvoiceTable",children:[s&&(0,Y.jsxs)("div",{style:{padding:"50px"},children:[(0,Y.jsxs)("h3",{children:[(0,Y.jsx)(i.A,{})," ",s.submission.from,(0,Y.jsxs)(N,{style:{float:"right"},children:[(0,Y.jsx)(n.A,{})," ",z()(s.submission.createdat).format("DD/MM/YYYY HH:mm:ss")]})]}),(0,Y.jsx)(g.A,{}),(0,Y.jsx)(j.A,{direction:"vertical",children:JSON.parse(s.submission.data).map((e=>(0,Y.jsxs)(j.A,{children:[(0,Y.jsx)("div",{style:{minWidth:"400px",display:"inline-block",color:"gray"},children:(0,Y.jsxs)(m.A.Title,{level:5,children:[e.label," (",(0,Y.jsx)("i",{children:e.type}),")"]})}),(0,Y.jsx)("div",{children:(0,Y.jsx)(m.A.Title,{level:5,children:B(e)})})]})))}),(0,Y.jsx)(g.A,{}),"pending"!==s.status&&(0,Y.jsx)(f.A,{message:"This approve task was completed at ".concat(z()(s.updatedAt).format("DD/MM/YYYY HH:mm:ss"),"."),type:"success",showIcon:!0,style:{margin:"10px 0"}}),1===s.auto_finish&&"pending"===s.status&&(0,Y.jsx)(f.A,{message:'This approve task will automatically finish with outcome "'.concat(s.auto_finish_outcome,'" after ').concat(z()(s.auto_finish_date).format("DD/MM/YYYY"),"."),type:"info",showIcon:!0,closable:!0,style:{margin:"10px 0"}}),1===s.escalate&&"pending"===s.status&&(0,Y.jsx)(f.A,{message:"This approve task will be automatically escalated to ".concat(s.escalate_email," after ").concat(z()(s.escalate_date).format("DD/MM/YYYY"),"."),type:"info",showIcon:!0,closable:!0,style:{margin:"10px 0"}}),(0,Y.jsxs)(v.A,{children:[(0,Y.jsx)(w.A,{md:12,children:"pending"===s.status?(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(y.A.TextArea,{rows:7,value:F,onChange:e=>I(e.target.value),disabled:"pending"!==s.status}),1===s.require_comment&&(0,Y.jsx)("small",{children:"Comment is required for this approve task."}),(0,Y.jsx)(g.A,{}),(0,Y.jsx)(j.A,{children:JSON.parse(s.outcomes).map((e=>(0,Y.jsx)(h.Ay,{style:{background:e.color,color:"white"},disabled:s.require_comment&&(!F||""===F),loading:P.approveLoading,onClick:()=>(async e=>{q((e=>({...e,approveLoading:!0})));const a=await(0,d.Ay)("workflow/approve",{params:{id:s.id,comment:F,signature:L,status:e,sub_id:s.submission_id}},"post",{...d.$K,"Content-Type":"application/json"});a.result&&a.result.success&&(await O(),C(null)),q((e=>({...e,approveLoading:!1})))})(e.title),children:e.title})))})]}):(0,Y.jsxs)(Y.Fragment,{children:[s.comment&&(0,Y.jsx)(D,{children:(0,Y.jsx)("pre",{children:s.comment})}),(0,Y.jsx)(g.A,{}),(0,Y.jsx)(h.Ay,{style:{background:JSON.parse(s.outcomes).filter((e=>e.title===s.status))[0].color,color:"white"},size:"small",children:s.status})]})}),(0,Y.jsx)(w.A,{md:12,children:"approveSign"===s.type&&(0,Y.jsx)("div",{tabIndex:"0",onClick:()=>{s.signature||_(!0)},style:{border:"1px solid lightgray",borderRadius:"10px",margin:"5px auto",padding:"5px",maxWidth:"250px",cursor:"pointer"},children:(0,Y.jsx)("img",{src:"pending"===s.status?L||"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 200 43' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M74.105 8.924h1.482c-.045-1.63-1.487-2.814-3.555-2.814-2.043 0-3.61 1.168-3.61 2.923 0 1.417 1.015 2.247 2.65 2.69l1.204.328c1.089.288 1.929.646 1.929 1.551 0 .994-.95 1.65-2.257 1.65-1.183 0-2.168-.526-2.257-1.635h-1.542c.1 1.845 1.527 2.983 3.809 2.983 2.391 0 3.768-1.258 3.768-2.983 0-1.834-1.635-2.545-2.928-2.864l-.994-.258c-.796-.204-1.855-.577-1.85-1.551 0-.865.79-1.507 2.043-1.507 1.169 0 1.999.547 2.108 1.487zM77.443 16.431h1.486V8.795h-1.486v7.636zm.75-8.815c.512 0 .94-.397.94-.885 0-.487-.428-.89-.94-.89-.517 0-.94.403-.94.89s.423.886.94.886zM84.13 19.439c1.945 0 3.446-.89 3.446-2.839V8.795h-1.457v1.238h-.11c-.263-.473-.79-1.338-2.211-1.338-1.845 0-3.202 1.457-3.202 3.888 0 2.436 1.387 3.734 3.192 3.734 1.402 0 1.943-.79 2.212-1.278h.094v1.501c0 1.179-.82 1.7-1.949 1.7-1.237 0-1.72-.62-1.983-1.043l-1.278.527c.403.92 1.422 1.715 3.247 1.715zm-.014-4.355c-1.328 0-2.019-1.02-2.019-2.52 0-1.467.676-2.606 2.019-2.606 1.297 0 1.993 1.059 1.993 2.605 0 1.576-.71 2.52-1.993 2.52zM91.056 11.897c0-1.218.746-1.914 1.78-1.914 1.01 0 1.62.661 1.62 1.77v4.678h1.487v-4.857c0-1.89-1.039-2.879-2.6-2.879-1.149 0-1.9.532-2.252 1.343h-.095V8.795H89.57v7.636h1.486v-4.534zM101.761 16.431h1.536v-4.44h5.076v4.44h1.542V6.249h-1.542v4.425h-5.076V6.249h-1.536v10.182zM115.324 16.585c1.665 0 2.843-.82 3.181-2.063l-1.407-.254c-.268.721-.914 1.09-1.759 1.09-1.273 0-2.128-.826-2.168-2.298h5.429v-.527c0-2.759-1.651-3.838-3.381-3.838-2.128 0-3.53 1.621-3.53 3.968 0 2.371 1.382 3.922 3.635 3.922zm-2.148-4.638c.06-1.084.845-2.024 2.053-2.024 1.154 0 1.909.855 1.914 2.024h-3.967zM120.249 16.431h1.487v-4.663c0-1 .77-1.72 1.824-1.72.309 0 .657.054.776.089V8.715a6.07 6.07 0 00-.632-.035c-.894 0-1.66.507-1.938 1.328h-.08V8.795h-1.437v7.636zM128.64 16.585c1.665 0 2.844-.82 3.182-2.063l-1.407-.254c-.269.721-.915 1.09-1.76 1.09-1.273 0-2.128-.826-2.168-2.298h5.429v-.527c0-2.759-1.65-3.838-3.38-3.838-2.128 0-3.53 1.621-3.53 3.968 0 2.371 1.382 3.922 3.634 3.922zm-2.148-4.638c.06-1.084.845-2.024 2.054-2.024 1.153 0 1.909.855 1.914 2.024h-3.968z' fill='%238894AB'/%3E%3Cpath d='M1 38.602c11.246 3.197 22.182-.99 31.508-7.172 4.932-3.27 9.826-7.183 12.825-12.341 1.195-2.057 2.656-5.626-1.106-5.658-4.093-.034-7.14 3.662-8.668 7.022-2.19 4.819-2.268 10.526.407 15.17 2.531 4.395 6.778 6.474 11.845 5.62 5.293-.893 9.92-4.508 13.765-7.986a40.714 40.714 0 003.966-4.093c.142-.17.642-1.006.966-1.064.12-.021.298 3.643.33 3.843.288 1.79 1.191 3.806 3.305 3.867 2.69.078 4.94-2.172 6.75-3.83.61-.559 2.55-3.241 3.583-3.241.425 0 1.249 2.143 1.437 2.428 2.484 3.764 6.132 2.401 8.96-.238.52-.485 3.305-4.367 4.436-3.667.911.563 1.313 1.893 1.78 2.778.76 1.441 1.722 2.468 3.33 3.004 3.493 1.166 7.261-2.102 10.803-2.102 1.033 0 1.561.568 2.11 1.351.749 1.068 1.521 1.813 2.873 2.103 4.188.898 7.617-3.077 11.667-2.728 1.181.101 2.063 1.292 2.949 1.927 1.788 1.28 3.938 2.167 6.127 2.478 3.509.499 7.027-.162 10.447-.9 5.905-1.277 11.752-2.799 17.667-4.031' stroke='%23DFE3ED' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3Cg clip-path='url(%23clip0)' fill='%23DFE3ED'%3E%3Cpath d='M196.514 17.657L184.491 3.13a.665.665 0 00-.938-.089l-2.905 2.405a.666.666 0 00-.089.938l12.023 14.526a.664.664 0 00.451.239.666.666 0 00.488-.15l2.905-2.405a.666.666 0 00.088-.938zM181.437 9.536l-10.582 2.869a.666.666 0 00-.472.48l-4.228 16.795 7.82-6.472a3.34 3.34 0 01.815-4.137 3.337 3.337 0 014.693.442 3.338 3.338 0 01-.442 4.694 3.322 3.322 0 01-2.438.75 3.335 3.335 0 01-1.778-.721l-7.82 6.471 17.289-1.014a.668.668 0 00.561-.374l4.796-9.859-8.214-9.924z'/%3E%3C/g%3E%3Cdefs%3E%3CclipPath id='clip0'%3E%3Cpath transform='rotate(5.386 167.573 0)' fill='%23fff' d='M167.573 0h32v32h-32z'/%3E%3C/clipPath%3E%3C/defs%3E%3C/svg%3E":s.signature,style:{width:"100%"}})})})]}),(0,Y.jsx)(g.A,{}),1===s.reassign&&"pending"===s.status&&(0,Y.jsxs)("p",{children:["\u273b You can reassign this approve task to others.",(0,Y.jsxs)(j.A.Compact,{style:{marginLeft:"10px"},children:[(0,Y.jsx)(y.A,{value:T,onChange:e=>H(e.target.value)}),(0,Y.jsx)(h.Ay,{type:"primary",disabled:!T||""===T,loading:P.reassignLoading,onClick:()=>(async()=>{q((e=>({...e,reassignLoading:!0})));const e=await(0,d.Ay)("workflow/reassign",{params:{id:s.id,email:T}},"post",{...d.$K,"Content-Type":"application/json"});e.result&&e.result.success&&(await O(),C(null)),q((e=>({...e,reassignLoading:!1})))})(),children:"Reassign"})]})]})]}),!s&&(0,Y.jsx)(l.default,{scroll:{x:1400},loading:P.loading,rowKey:e=>e.id,dataSource:e,columns:R,className:"invoiceListTable",showSorterTooltip:!1})]})]})}),(0,Y.jsx)(S,{className:"addSignModal",visible:E,type:"sign",user:{first_name:"Signer"},onClose:()=>_(!1),handleSubmit:e=>{K(e),_(!1)},showSaved:!0,user_id:V.user_id})]})}},85908:(e,a,s)=>{function t(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.3;return"\n      -webkit-transition: all ".concat(e,"s cubic-bezier(0.215, 0.61, 0.355, 1);\n      -moz-transition: all ").concat(e,"s cubic-bezier(0.215, 0.61, 0.355, 1);\n      -ms-transition: all ").concat(e,"s cubic-bezier(0.215, 0.61, 0.355, 1);\n      -o-transition: all ").concat(e,"s cubic-bezier(0.215, 0.61, 0.355, 1);\n      transition: all ").concat(e,"s cubic-bezier(0.215, 0.61, 0.355, 1);\n  ")}function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return"\n      -webkit-border-radius: ".concat(e,";\n      -moz-border-radius: ").concat(e,";\n      -ms-transition: ").concat(e,";\n      -o-border-radius: ").concat(e,";\n      border-radius: ").concat(e,";\n  ")}function n(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"none";return"\n      -webkit-box-shadow: ".concat(e,";\n      -moz-box-shadow: ").concat(e,";\n      box-shadow: ").concat(e,";\n  ")}s.d(a,{MS:()=>n,Vq:()=>i,kY:()=>t})}}]);